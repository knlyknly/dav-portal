!function(a){var b=a.global,c=b.document,d=navigator.userAgent.toLowerCase(),e=function(){var a,b={windows:/windows|win32/,macintosh:/macintosh|mac_powerpc/,linux:/linux/};for(a in b)if(b[a].test(d))return a;return"other"}(),f=function(){for(var a,b=function(a){var b=new RegExp(a+"(\\d+\\.\\d+)").exec(d);return b?parseFloat(b[1]):0},c=[{tests:[/msie/,/^(?!.*opera)/],name:"ie",version:b("msie "),prefix:"ms",cssPrefix:"-ms-",engine:{name:"trident",version:b("trident\\/")||4}},{tests:[/gecko/,/^(?!.*webkit)/],name:"firefox",version:b("\\bfirefox/"),prefix:"Moz",cssPrefix:"-moz-",engine:{name:"gecko",version:b("rv:")||4}},{tests:[/\bchrome\b/],name:"chrome",version:b("\\bchrome/"),prefix:"webkit",cssPrefix:"-webkit-",engine:{name:"webkit",version:b("webkit\\/")}},{tests:[/safari/,/^(?!.*\bchrome\b)/],name:"safari",version:b("version/"),prefix:"webkit",cssPrefix:"-webkit-",engine:{name:"webkit",version:b("webkit\\/")}},{tests:[/opera/],name:"opera",version:b("version/"),prefix:"O",cssPrefix:"-o-",engine:{name:b("presto\\/")?"presto":"webkit",version:b("presto\\/")||b("webkit\\/")}}];c.length;){for(a=c.shift();a.tests.length&&a.tests[0].test(d);)a.tests.shift();if(!a.tests.length)return delete a.tests,a}return{name:"other",version:0,engine:{name:"unknown",version:0}}}(),g="ie"===f.name&&f.version,h=c.createElement("div"),i=h.style;a.define("nx.env",{statics:{documentMode:c.documentMode||0,compatMode:c.compatMode,strict:"CSS1Compat"===c.compatMode,secure:"https:"===location.protocol.toLowerCase(),userAgent:d,os:e,browser:f,SUPPORT_MAP:{addEventListener:!!c.addEventListener,dispatchEvent:!!c.dispatchEvent,getBoundingClientRect:!!c.documentElement.getBoundingClientRect,onmousewheel:"onmousewheel"in c,XDomainRequest:!!window.XDomainRequest,crossDomain:!(!window.XDomainRequest&&!window.XMLHttpRequest),getComputedStyle:"getComputedStyle"in window,iePropertyChange:!!(g&&9>g),w3cChange:!g||g>8,w3cFocus:!g||g>8,w3cInput:!g||g>9,innerText:"innerText"in h,firstElementChild:"firstElementChild"in h,cssFloat:"cssFloat"in i,opacity:/^0.55$/.test(i.opacity),filter:"filter"in i,classList:!!h.classList,removeProperty:"removeProperty"in i,touch:"ontouchstart"in c.documentElement},KEY_MAP:{BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,META:"chrome"===f.name||"webkit"===f.name||"safari"===f.name?91:224,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,HELP:47,LEFT_WINDOW:91,RIGHT_WINDOW:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_PLUS:107,NUMPAD_ENTER:108,NUMPAD_MINUS:109,NUMPAD_PERIOD:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,NUM_LOCK:144,SCROLL_LOCK:145}}})}(nx),nx.ready=function(a){var b,c=new nx.Object;return b=function(){c.release("recursive"),"string"==typeof a&&(a=nx.path(global,a));var b,d;if("function"==typeof a){if(!a.__nx__)return void c.retain("recursive",a(c));b=new a}else b=a;d=nx.path(b,"dom"),d instanceof Node?(document.body.appendChild(d),c.retain("recursive",{release:function(){document.body.removeChild(d),b.release()}})):c=b},"interactive"===document.readyState||"complete"===document.readyState?b():(window.addEventListener("load",b),c.retain("recursive",{release:function(){window.removeEventListener("load",b)}})),c},function(a){a.path(a.global,"nx.util.url",function(){var a=window.location.href,b=window.location.hash,c=a.indexOf("?")>=0&&a.substring(a.indexOf("?")+1);c&&c.indexOf("#")>=0&&(c=c.substring(0,c.indexOf("#")));var d=window.location.protocol,e=window.location.host,f=window.location.hostname,g=window.location.port,h=window.location.pathname;return c&&(c=c.split("&").reduce(function(a,b){var c,d,e=b.indexOf("=");return e>=0?(c=b.substring(0,e),d=b.substring(e+1)):(c=b,d=!0),a[c]=d,a},{})),b&&(b=b.split("&").reduce(function(a,b){var c,d,e=b.indexOf("=");return e>=0?(c=b.substring(0,e),d=b.substring(e+1)):(c=b,d=null),a[c]=d,a},{})),{href:a,protocol:d,host:e,hostport:e,hostname:f,port:g,pathname:h,search:c,hash:b}}())}(nx),function(a){var b=a.define("nx.util.fullscreen",{statics:{status:function(){return!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)},toggle:function(a){var c=b.status();b.set(!c)},set:function(a){a?document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}}})}(nx),function(a){var b=a.env.browser;b.cssPrefix,a.define("nx.util.cssclass",{"static":!0,methods:{has:function(a,b){return a.classList?a.classList.contains(b):(" "+a.className+" ").indexOf(" "+b+" ")>=0},add:function(a,b){return a.classList?(a.classList.add(b),String(a.className)):(this.has(a,b)||(a.className=(a.className||"")+" "+b),String(a.className))},remove:function(a,b){return a.classList?a.classList.remove(b):a.className=String(a.className||"").split(" ").filter(function(a){return a&&a!==b}).join(" ")},toggle:function(a,b,c){return arguments.length>2?c?this.add(a,b):this.remove(a,b):a.classList?a.classList.toggle(b):void(this.has(a,b)?this.remove(a,b):this.add(a,b))}}})}(nx),function(a){var b=a.env.browser,c=b.cssPrefix,d=a.define("nx.util.cssstyle",{"static":!0,methods:{has:function(a,b){var d=a.style.cssText;return 0===d.indexOf(b)||0===d.indexOf(c+b)},get:function(a,b){return a.style[d.camelize(b)]},getBound:function(a){var b=a.getBoundingClientRect();return{left:b.left,top:b.top,width:b.width,height:b.height,right:b.right,bottom:b.bottom}},set:function(b,c,e){if("string"!=typeof c){var f="";return a.each(c,function(a,b){var c=d.stylize(b,a);f+=c.text}),f=b.style.cssText+f,b.style.cssText=f,f}var g=d.stylize(c,e);return b.style.cssText+=g.text,g.value},remove:function(a,b){return a.style.removeProperty(d.camelize(b))},camelize:function(d){var e;switch(d){case"float":e="cssFloat";break;default:0===d.indexOf(c)&&(d=b.prefix+d.substring(c.length-1)),e=a.string.camelize(d)}return e},stylize:function(b,e){b=a.string.uncamelize(b);var f,g,h="";switch(b){case"left":case"right":case"top":case"bottom":case"width":case"height":"number"==typeof e&&(e+="px");break;case"display":"string"!=typeof e?e=e?"":"none":"flex"===e&&(g=c+e);break;case"user-select":case"transform-origin":case"transform-style":case"animation":case"animation-name":case"animation-duration":case"animation-delay":case"animation-iteration-count":case"animation-timing-function":case"animation-fill-mode":case"flex-direction":case"flex-flow":case"flex-wrap":case"justify-content":case"align-content":case"align-items":case"flex":case"order":case"flex-grow":case"flex-shrink":case"flex-basis":case"align-self":f=c+b;break;case"content":e='"'+e+'"';break;case"background-image":g=e.replace(/\S*gradient\(/gi,function(a){return c+a});break;case"transform":f=c+b,a.is(e,Array)&&(3==e.length?e=d.toCssTransformMatrix(e):4===e.length&&(e=d.toCssTransformMatrix3d(e)))}return f?h+=f+":"+(g||e)+";":g&&(h+=b+":"+g+";"),h+=b+":"+e+";",{key:b,prefixKey:f,value:e,prefixValue:g,text:h}},toCssTransformMatrix:function(a){if(!a)return"none";var b=[a[0][0],a[0][1],a[1][0],a[1][1],a[2][0],a[2][1]].join(",").replace(/-?\d+e[+-]?\d+/g,"0");return"matrix("+b+")"},toCssTransformMatrix3d:function(a){if(!a)return"none";var b=a.map(function(a){return a.join(",")}).join(",").replace(/-?\d+e[+-]?\d+/g,"0");return"matrix3d("+b+")"},toCssDisplayVisible:function(a){return a?"":"none"}}})}(nx),function(a){var b=a.env.browser.cssPrefix,c=a.util.cssstyle.stylize,d=(a.string.uncamelize,a.string.camelize),e=function(){var b=function(c){if(c.definition){this.definition=c.definition;var e,f,g=b.KEYS;for(this.name=c.name||"keyframes-"+a.uuid(),e=1;e<g.length;e++)f=g[e],this[f]=c[f]||c[d(f)]}else this.definition=c.definition};return b.KEYS=["name","duration","timing-function","delay","iteration-count","direction","fill-mode","play-state"],b.DEFAULTS={duration:"0s","timing-function":"ease",delay:"0s","iteration-count":"infinite",direction:"normal","fill-mode":"none","play-state":"running"},b}(),f={selector:{"::placeholder":{regexp:/::placeholder/g,handler:function(){return"::"+b+"input-placeholder"}},"::scrollbar":{regexp:/::scrollbar/g,handler:function(){return"::"+b+"scrollbar"}},"::scrollbar-track":{regexp:/::scrollbar-track/g,handler:function(){return"::"+b+"scrollbar-track"}},"::scrollbar-thumb":{regexp:/::scrollbar-thumb/g,handler:function(){return"::"+b+"scrollbar-thumb"}}}},g=a.define("nx.util.csssheet",{"static":!0,methods:{create:function(b,c,d){return"string"!=typeof b&&(d=c,c=b,b="jss-"+a.serial()),a.ready(function(){var a,e,f=g._css(c),h=document.getElementsByTagName("head")[0];return e=document.createElement("style"),e.setAttribute("id",b),e.setAttribute("type","text/css"),e.setAttribute("media","screen"),e.setAttribute("rel","stylesheet"),e.appendChild(document.createTextNode(f)),h.appendChild(e),a=d&&d(e,b),{release:function(){a&&a.release(),a=null,e&&h.removeChild(e),e=null}}})},keyframes:function(a){return new e(a)},_pair:function(d,f,h){if("animation"===f&&h instanceof e){if(h.name||(h.name="keyframes-"+a.uuid()),d.push("@"+b+"keyframes "+h.name+" {"+g._css(h.definition)+"}"),navigator.userAgent.indexOf("Safari/6")>=0)return function(a){var b,d,f,g,h=e.KEYS,i=e.DEFAULTS,j=[];for(b=0;b<h.length;b++)d=h[b],f=a[d]||"number"==typeof a[d]?a[d]:i[d],g=c("animation-"+d,f),j.push(g.text);return j.join("")}(h);h=function(a){var b,c,d=e.KEYS,f=e.DEFAULTS,g=[];for(b=0;b<d.length;b++)c=d[b],a[c]||"number"==typeof a[c]?g.push(a[c]):g.push(f[c]);return g.join(" ")}(h)}var i=c(f,h);return i.text},_rule:function(c,d,h){var i,j,k="";if(h instanceof e)return c.push("@"+b+"keyframes "+d+" {"+g._css(h.definition)+"}"),"";for(i in h)j=h[i],k+=g._pair(c,i,j);return a.each(f.selector,function(a,b){d.indexOf(b)>=0&&(d=d.replace(a.regexp,a.handler))}),d+"{"+k+"}"},_css:function(a){var b,c=[""];for(b in a)c[0]+=g._rule(c,b,a[b]);return c.join("")}}})}(nx),function(a){var b=a.env.browser,c=(b.cssPrefix,a.define("nx.util.event",{statics:{supported:function(a){return a===window?c.EVENTS_WINDOW.slice():c.EVENTS_BASIC.concat(c.EVENTS_TAG[a.tagName.toLowerCase()])},EVENTS_WINDOW:["load","unload","resize"],EVENTS_BASIC:["click","dblclick","contextmenu","mousedown","mouseup","mousemove","mouseenter","mouseleave","mouseover","mouseout","keydown","keyup","keypress","focus","blur","touchstart","touchmove","touchend","touchcancel"],EVENTS_TAG:{form:["reset","submit"],input:["change","input"],textarea:["change","input"],select:["select"],img:["load","error"]}}}))}(nx),function(a){a.define("nx.util.hash",{"static":!0,properties:{map:function(){return new a.Map}},methods:{init:function(){this.inherited(),window.addEventListener("hashchange",this.onhashchange.bind(this)),this.onhashchange()},getHashString:function(){var a=window.location.hash;return a||(a=window.location.href.indexOf("#"),a=a>=0?window.location.href.substring(a):""),a},getHashMap:function(){return this.toHashMap(this.getHashString())},setHashMap:function(b){var c=[];return a.each(b,function(a,b){"#"===b?c.unshift(a||""):(a||"string"==typeof a)&&c.push(b+"="+a)}),window.location.href="#"+c.join("&")},onhashchange:function(){var a,b,c=this.getHashString();b=this.toHashMap(c),a=this._lastHashMap||{},this.updateMap(a,b),this._lastHashMap=b},updateMap:function(b,c){var d=this.map(),e=Object.prototype.hasOwnProperty;a.each(b,function(a,b){e.call(c,b)||d.remove(b)}),a.each(c,function(a,b){d.set(b,a)})},toHashMap:function(b){if(!b)return{};var c,d={};return c=b.substring(1).split("&"),-1===c[0].indexOf("=")?d["#"]=c.shift():d["#"]=null,a.each(c,function(a){a=a.split("="),a.length<2&&(a[1]=!0),d[a[0]]=a[1]}),d}}})}(nx),function(a){var b=Object.prototype.hasOwnProperty,c=a.global.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,d=window.cancelAnimationFrame||window.mozCancelAnimationFrame;a.path(a.global,"nx.util.paint",function(b){var e=new a.Object,f=function(){var d=a.date.now();e.release("recursive"),e.retain("recursive",b(d)),g=c(f)},g=c(f);return e.retain({release:function(){d(g),e.release("recursive")}}),e}),a.path(a.global,"nx.util.paint.animate",function(){var c,d,e,f,g;return f=new a.Map,g=new a.List,f.monitor(function(b,c){c.start(a.date.now())}),g.monitorContaining(function(a){var b=a.animation().target();return f.get(b)||f.set(b,a),function(){if(a===f.get(b)){var c=g.find(function(a){return a.animation().target()===b});c?f.set(b,c):f.remove(b)}}}),g.watch("length",function(b,c){c?e=e||a.util.paint(function(){var b=a.date.now();new a.Map;a.each(g,function(a,c){var d;a.start()&&(d=a.getRate(b),a.draw(d)&&(a.stop(b),a.end(b),a.release()))})}):e&&e.release()}),c=a.define({properties:{animation:null,start:0,stop:0,end:0,duration:0,timingFunction:"linear",iterationCount:1,direction:"normal"},methods:{init:function(b){this.inherited(),a.sets(this,b)},getRate:function(b){b=b||a.date.now();var c,d=this.timingFunction()||a.identity;switch(d){case"linear":c=a.identity;break;case"ease":}return Math.max(c((b-this.start())/this.duration()),0)},draw:function(b){b=b>=0?b:this.getRate();var c=this.animation().target(),d=this.animation().state0(),e=this.animation().state1(),f=this.direction(),g=this.iterationCount(),h=!1;return"infinite"===g?b-=Math.floor(b):b>g&&(b=1,h=!0),"alternate"===f&&(b=1-b),a.each(e,function(e,f){var g=d[f];a.path(c,f,e*b+g*(1-b))}),h}}}),d=a.define({properties:{target:null,state0:{value:function(){return{}}},state1:{value:function(){return{}}}},methods:{init:function(a){this.inherited(),this.target(a)},reset:function(){var b=this.target(),c=this.state0(),d=this.state1();a.each(d,function(d,e){c[e]=a.path(b,e)})},set:function(c,d){d=d?d+".":"";var e=this.target(),f=this.state0(),g=this.state1();a.each(c,function(c,h){"string"==typeof h&&("number"==typeof c?(b.call(f,d+h)||(f[d+h]=a.path(e,d+h)),g[d+h]=c):this.set(c,d+h))}.bind(this))},start:function(b,d,e,f){"number"==typeof b?"alternate"===d||"normal"===d?(f=d,e=1,d="linear"):("string"!=typeof d&&"function"!=typeof d&&(f=e,e=d,d="linear"),"number"!=typeof e&&isNaN(1*e)?(f="alternate"===e?"alternate":"normal",e=1):(e=e||1,f="alternate"===f?"alternate":"normal")):(b=b||{},f="alternate"===b.direction?"alternate":"normal",e=b.iterationCount||1,d=b.timingFunction||"linear",b=b.duration||1e3);var h=new c({animation:this,duration:b,timingFunction:d,iterationCount:e,direction:f});return h.retain({release:function(){h.stop(a.date.now()),g.remove(h)}}),g.push(h),h}}}),function(a,b){var c=new d(a);return b(c),c}}())}(nx),function(){nx.path(nx.global,"nx.util.ajax",function(){var a=nx.global.$?$.ajax:void 0;return function(b){var c=nx.extend({},b),d=new nx.Object;c.success=function(){d.release("abort"),b.success&&nx.func.apply(b.success,this,d,arguments)},c.error=function(){d.release("abort"),b.error&&nx.func.apply(b.error,this,d,arguments)},c.complete=function(){d.release("abort"),b.complete&&nx.func.apply(b.complete,this,d,arguments)};var e=a(c);return d.retain("abort",{release:function(){e.abort()}}),d}}())}(nx),function(a){a.path(a.global,"nx.util.ajaxs",function(){var b=a.util.ajax,c=function(a){var b,c=[];if(a)for(b in a)c.push(b);return c};return function(d){var e,f,g,h,i,j,k=new a.Object,l=d.ajaxs;h={},f=0,i=null,g=c(l),e=g.length;var m=function(){i?(d.error&&d.error(i,j),d.complete&&d.complete()):(d.success&&d.success(h),d.complete&&d.complete()),a.each(g,function(a){k.release(a)})};return a.each(l||{},function(c,d){c=a.extend({},c);var g=c.complete,l=c.success,n=c.error;c.success=function(b){l&&a.func.apply(l,arguments),h[d]=b,f++},c.error=function(b){a.func.apply(n,arguments),i=d,j=b},c.complete=function(){g&&a.func.apply(g,arguments),(i||f>=e)&&m&&m()},k.retain("key",b(c))}),k}}())}(nx),function(a){var b=a.math.square;a.define("nx.ui.capture.MouseProcessor",{properties:{msHold:400,event:{},track:{},handler:{}},methods:{enable:function(a){var b=this;a.addEventListener("mousedown",function(a){b.attach(a)},!0),a.addEventListener("mousemove",function(a){b.move(a)},!0),a.addEventListener("mouseup",function(a){b.end(a)},!0),a.addEventListener("mousedown",function(a){b.detach(a)})},attach:function(a){this.handler(null),this.event(a),a.capture&&(this._lastCapture=a.capture),a.capture=this.capture.bind(this)},detach:function(a){this._lastCapture?(a.capture=this._lastCapture,delete this._lastCapture):delete a.capture},capture:function(a){var b=this.event();if(a&&b&&0===b.button&&!this.handler()){this.handler(a);var c=[];return this.track(c),this.track().push([b.clientX,b.clientY]),this._timer=setTimeout(this.hold.bind(this),this.msHold()),!0}return!1},hold:function(){var a=this.handler(),b=this.event();this.isTrackLong()&&(b.capturedata||(b.capturedata=this._makeDragData(b)),this._call(a,"capturehold",b)),clearTimeout(this._timer)},move:function(a){var b=this.handler();b&&(a.capturedata=this._makeDragData(a),this._call(b,"capturedrag",a))},end:function(a){var b=this.handler();b&&(a.capturedata=this._makeDragData(a),this._call(b,"capturedragend",a),this.isTrackLong()&&this._call(b,"capturetap",a),this._call(b,"captureend",a)),this.handler(null),this.track(null),this.event(null),clearTimeout(this._timer)},cancel:function(){},isTrackLong:function(){var c=this.track();if(!c)return!1;var d=c[0];return a.each(c,function(a){return b(a[0]-d[0])+b(a[1]-d[1])>9?!1:void 0})},_call:function(b,c,d){if(b[c]&&"function"==typeof b[c]){var e=b[c].call(b);if(e&&"function"==typeof e)return e(d)}else a.is(b,a.ui.Element)&&b.fire(c,d)},_makeDragData:function(a){var b=this.track(),c=[a.clientX,a.clientY],d=b[0],e=b[b.length-1];return c.time=a.timeStamp,b.push(c),d||(d=e=c.slice()),{target:this.handler(),origin:d,position:c,offset:[c[0]-d[0],c[1]-d[1]],delta:[c[0]-e[0],c[1]-e[1]],track:b}}}})}(nx),function(a){a.geometry.Vector,a.geometry.Math,a.define("nx.ui.capture.touch.Matcher",{properties:{processor:null},methods:{init:function(a){this.inherited(),this.processor(a)},match:function(a){return!1},affect:a.idle}})}(nx),function(a){a.geometry.Vector,a.geometry.Math,a.define("nx.ui.capture.touch.ClearMatcher",a.ui.capture.touch.Matcher,{properties:{timer:null},methods:{match:function(a){return 0===a.count()},affect:function(a){var b=this.processor();return b.trigger("captureend",a.lastEvent(),0,function(){b.reset()})}}})}(nx),function(a){a.geometry.Vector,a.geometry.Math,a.define("nx.ui.capture.touch.TapMatcher",a.ui.capture.touch.Matcher,{methods:{match:function(a){return 0===a.count()&&2===a.timeline().length&&"touchend"===a.timeline()[1].type},affect:function(a){var b=this.processor(),c=a.lastEvent();c.capturedata={position:a.touches()[0].track[0]},b.trigger("capturetap",c)}}})}(nx),function(a){a.geometry.Vector,a.geometry.Math,a.define("nx.ui.capture.touch.HoldMatcher",a.ui.capture.touch.Matcher,{methods:{match:function(a){return 1===a.timeline().length},affect:function(a){var b=this.processor(),c=a.lastEvent();return c.capturedata={position:a.touches()[0].track[0]},b.trigger("capturehold",a.lastEvent(),b.msHold())}}})}(nx),function(a){var b=(a.geometry.Vector,a.geometry.Rectangle,a.geometry.Math,a.define("nx.ui.capture.touch.DragMatcher",a.ui.capture.touch.Matcher,{properties:{touch:null,origin:null,ending:!1},methods:{match:function(a){if(b.isOneTouch(a)){if(this.touch())return!0;var c=b.getTouch(a);return this.touch(c),this.origin(c.track.length-1),!1}return this.touch()?(this.ending(!0),!0):!1},affect:function(a){var b=this.processor(),c=this.ending()?"capturedragend":"capturedrag",d=a.lastEvent();d.capturedata=this.makeZoomData(this.touch().track),b.trigger(c,d),this.ending()&&(this.touch(null),this.ending(!1))},makeZoomData:function(a){var b=a[this.origin()],c=a[a.length-1],d=a[Math.max(this.origin(),a.length-2)];return{position:c.slice(),origin:b.slice(),previous:d.slice(),delta:[c[0]-d[0],c[1]-d[1]],offset:[c[0]-b[0],c[1]-b[1]],track:a.slice(this.origin())}}},statics:{isOneTouch:function(a){return 1===a.count()},getTouch:function(a){var b,c,d=a.touches();for(b=0;b<d.length;b++)if(c=d[b],!c.released)return c},getTrack:function(a){var b,c,d=a.touches();for(b=0;b<d.length;b++)if(c=d[b],!c.released)return c.track}}}))}(nx),function(a){var b=(a.geometry.Vector,a.geometry.Rectangle,a.geometry.Math,a.define("nx.ui.capture.touch.TransformMatcher",a.ui.capture.touch.Matcher,{properties:{origin:null,previous:null},methods:{match:function(a){if(b.isTwoTouch(a)){if(this.origin())return!0;var c=b.getRect(a);return this.origin(c),this.previous(c),!1}return!1},affect:function(a){var c=this.processor(),d=a.lastEvent();return d.data=this.makeZoomData(a),c.trigger("capturetransform",d),this.previous(b.getRect(a)),{release:function(){var a=this.processor().session();b.isTwoTouch(a)||(this.origin(null),this.previous(null))}.bind(this)}},makeZoomData:function(a){var c=this.origin(),d=this.previous(),e=b.getRect(a);return{delta:{origin:[(d[0][0]+d[1][0])/2,(d[0][1]+d[1][1])/2],target:[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2],scale:b.distance(e)/b.distance(d),rotate:b.angle(e)/b.angle(d)},offset:{origin:[(c[0][0]+c[1][0])/2,(c[0][1]+c[1][1])/2],target:[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2],scale:b.distance(e)/b.distance(c),rotate:b.angle(e)/b.angle(c)}}}},statics:{isTwoTouch:function(a){return 2===a.count()},getRect:function(b){var c=[];return a.each(b.touches(),function(a){a.released||c.push(a.track[a.track.length-1])}),c},distance:function(a){var b=a[0],c=a[1],d=c[0]-b[0],e=c[1]-b[1];return Math.sqrt(d*d+e*e)},angle:function(a){var b=a[0],c=a[1],d=c[0]-b[0],e=c[1]-b[1];return Math.atan(e,d)}}}))}(nx),function(a){var b=a.geometry.Vector,c=a.geometry.Math,d=a.define("nx.ui.capture.touch.Session",{properties:{precisionTime:200,precisionDelta:5,lastEvent:null,count:0,indices:{value:function(){return{}}},touches:{value:function(){return[]}},timeline:{value:function(){return[]}}},methods:{update:function(a){var b=a.timeStamp,c=!1;d.eachTouch(a,function(d){var e=d.identifier,f=[d.clientX,d.clientY],g=a.type;g="touchcancel"===g?"touchend":g,this[g]&&this[g].call(this,b,e,f)!==!1&&(c=!0)}.bind(this)),c&&(this.lastEvent(a),this.fire("update"))},touchstart:function(a,b,d){var e,f,g=this.indices(),h=this.touches();e=g[b]=h.length,f=h[e]={id:b,index:h.length,track:[d]},this.count(this.count()+1);var i,j=this.timeline();1===j.length&&c.approximate(j[0].time,a,this.precisionTime())?i=j[0]:j.push(i={time:a,type:"touchstart",touches:[]}),i.touches[e]=f},touchmove:function(a,d,e){var f,g,h=this.indices(),i=this.touches();if(f=h[d],g=i[f],b.approximate(g.track[g.track.length-1],e,this.precisionDelta()))return!1;g.track.push(e);var j,k=this.timeline();j=k[k.length-1],"touchmove"===j.type&&c.approximate(j.time,a)||k.push(j={time:a,type:"touchmove",touches:[]}),j.touches[f]=g},touchend:function(a,b){var d,e,f=this.indices(),g=this.touches();d=f[b],e=g[d],f[b]=void 0,e.released=!0,this.count(this.count()-1);var h,i=this.timeline();h=i[i.length-1],"touchend"===h.type&&c.approximate(h.time,a)||i.push(h={time:a,type:"touchend",touches:[]}),h.touches[d]=e}},statics:{eachTouch:function(a,b){var c,d=a.changedTouches.length;for(c=0;d>c&&b(a.changedTouches[c],c)!==!1;c++);}}})}(nx),function(a){a.define("nx.ui.capture.TouchProcessor",{properties:{msDouble:200,msHold:400,event:{},handlers:{},matchers:{value:function(){return[new a.ui.capture.touch.HoldMatcher(this),new a.ui.capture.touch.TapMatcher(this),new a.ui.capture.touch.DragMatcher(this),new a.ui.capture.touch.TransformMatcher(this),new a.ui.capture.touch.ClearMatcher(this)]}},session:{watcher:function(a,b,c){this.release("session"),b&&this.retain("session",b.on("update",this.updateSession.bind(this)))}}},methods:{enable:function(a){var b=this;a.addEventListener("touchstart",function(a){b.attach(a)},!0),a.addEventListener("touchstart",function(a){b.detach(a)}),a.addEventListener("touchmove",function(a){b.update(a)},!0),a.addEventListener("touchend",function(a){b.update(a)},!0),a.addEventListener("touchcancel",function(a){b.update(a)},!0)},attach:function(b){this.event(b),b.capture&&(this._lastCapture=b.capture),b.capture=this.capture.bind(this),this.session()||this.session(new a.ui.capture.touch.Session)},detach:function(a){this._lastCapture?(a.capture=this._lastCapture,delete this._lastCapture):delete a.capture,this.update(a)},capture:function(b,c){var d=this.handlers();d||(d={},this.handlers(d),this.event().preventDefault());var e=!0;return c="string"==typeof c?c.replace(/\s/g,"").split(","):c,a.each(c,function(a){"end"===a?(d.captureend=d.captureend||[],d.captureend.push(b)):(a="capture"+a,b&&!d[a]&&(d[a]=b))}),e},update:function(a){this.session()&&(this.session().update(a),this.handlers()&&a.preventDefault())},reset:function(){this.handlers(null),this.session().release(),this.session(null)},trigger:function(b,c,d,e){return d?a.timer(d,function(){this.triggerAction(b,c),e&&e()}.bind(this)):(this.triggerAction(b,c),void(e&&e()))},triggerAction:function(b,c,d){var e=this,f=this.handlers();"captureend"===b?a.each(f&&f[b],function(a){e.triggerOne(a,b,c)}):f&&f[b]&&e.triggerOne(f[b],b,c)},triggerOne:function(a,b,c){a.fire(b,c)},updateSession:function(){var b=this.session();a.each(this.matchers(),function(a){if(a.release("affect"),a.match(b)){var c=a.affect(b);if(c&&a.retain("affect",c),c===!1)return!1}})}}})}(nx),function(a){var b=a.define("nx.ui.capture.CaptureManager",{properties:{mouseProcessor:{value:function(){return new a.ui.capture.MouseProcessor}},touchProcessor:{value:function(){return new a.ui.capture.TouchProcessor}}},methods:{enable:function(a){a?a.resolve&&(a=a._dom):a=document,this.mouseProcessor().enable(a),this.touchProcessor().enable(a)}},statics:{offsetTooClose:function(a){return Math.abs(a[0])<5&&Math.abs(a[1])<5},fixRect:function(b){return b?(b=a.clone(b),b.width<0&&(b.left+=b.width,b.width=-b.width),b.height<0&&(b.top+=b.height,b.height=-b.height),b):b}}});a.ready(function(){var a=new b;a.enable()})}(nx),function(a){var b=a.global,c=a.Hierarchical,d=a.util.cssclass,e=a.util.cssstyle,f=a.define("nx.ui.Element",a.Hierarchical,{properties:{xmlns:{set:function(){throw new Error("Unable to set xmlns of Element.")}},dom:{set:function(){throw new Error("Unable to set dom of Element.")},watcher:function(b,c){this.release("syncDomEvents"),a.is(c,Element)&&this.retain("syncDomEvents",this._sync_dom_events(c))}},childDefaultType:"nx.ui.Element",childList:{watcher:function(b,c){this.release("syncChildList"),a.is(c,a.List)&&this.retain("syncChildList",this._sync_child_list(c))}}},hierarchical:{capture:function(a,b){return this.hierarchicalUpdateCapture(a,b)},cssclass:function(a,b){return this.hierarchicalUpdateClass(a,b)},cssstyle:function(a,b){return this.hierarchicalUpdateStyles(a,b)},attributes:function(a,b){return this.hierarchicalUpdateAttributes(a,b)}},methods:{init:function(a,b){this.inherited(),this._xmlns=b||"",a instanceof Element?(this._dom=a,this.notify("dom")):(b?this._dom=document.createElementNS(b,a):this._dom=document.createElement(a||"nx-element"),this.notify("dom"),this.initView()),this.fire("ready")},initView:function(){var b,c=this,d=c.constructor,e=[];do b=d.__meta__.view,b&&e.unshift(b),d=d.__super__;while(d&&d!==a.ui.Element);a.each(e,function(a){c.retain(c.hierarchicalUpdate(a,c))})},append:function(a){return this.hierarchicalAppend(a,this)},appendTo:function(c){if(a.is(c,f))return c.append(this);var d=this.dom();return c&&c!==b&&c!==document||(c=document.body),c instanceof Element?(document.body.appendChild(d),this.parent(c),{release:function(){this.parent(null),document.body.removeChild(d)}.bind(this)}):void 0},hasAttribute:function(a){return this._dom.hasAttribute(a)},hasAttributeNS:function(a,b){return this._dom.hasAttributeNS(a,b)},getAttribute:function(a){return this._dom.getAttribute(a)},getAttributeNS:function(a,b){return this._dom.getAttributeNS(a,b)},setAttribute:function(a,b){return this._dom.setAttribute(a,b)},setAttributeNS:function(a,b,c){return this._dom.setAttributeNS(a,b,c)},removeAttribute:function(a){return this._dom.removeAttribute(a)},removeAttributeNS:function(a,b){return this._dom.removeAttributeNS(a,b)},hasClass:function(a){return d.has(this._dom,a)},addClass:function(a){return d.add(this._dom,a)},removeClass:function(a){return d.remove(this._dom,a)},toggleClass:function(a,b){return arguments.length>1?d.toggle(this._dom,a,b):d.toggle(this._dom,a)},getComputedStyle:function(a){return this._dom.getComputedStyle(a)},hasStyle:function(a){return this._dom.style.cssText.indexOf(a+":")>=0},getStyle:function(a){return e.get(this._dom,a)},setStyle:function(a,b){return e.set(this._dom,a,b)},removeStyle:function(a){return e.remove(this._dom,a)},getBound:function(){return e.getBound(this._dom)},_sync_dom_events:function(b){var c=this,d=a.util.event.supported(b),e=new a.Object;return a.each(d,function(a){var d=function(b){c.fire(a,b)};e.retain(this.on("+"+a,function(){b.addEventListener(a,d)})),e.retain(this.on("-"+a,function(){b.removeEventListener(a,d)}))},this),a.each(d,function(a){var d=function(b){c.fire(":"+a,b)};e.retain(this.on("+:"+a,function(){b.addEventListener(a,d,!0)})),e.retain(this.on("-:"+a,function(){b.removeEventListener(a,d,!0)}))},this),e},_sync_child_list:function(a){return a.monitorDiff(function(a){var b,c,d,e,f,g,h,i,e,f,j=a.diffs,k=a.drops,l=a.joins,m=this._dom;for(b=0;b<j.length;b++)switch(d=j[b],g=k[b],i=l[b],d[0]){case"splice":for(c=0;c<g.length;c++)e=g[c],e&&(f=e instanceof Node?e:e._dom,f instanceof Node&&m.removeChild(f));for(h=m.childNodes[d[1]],c=0;c<i.length;c++)e=i[c],e&&(f=e instanceof Node?e:e._dom,f instanceof Node&&(h?m.insertBefore(f,h):m.appendChild(f)));break;case"move":if(d[3]>0)for(h=m.childNodes[d[1]+d[2]+d[3]],c=d[2]-1;c>=0;c--)f=m.childNodes[d[1]+c],h?m.insertBefore(f,h):m.appendChild(f),h=f;else for(h=m.childNodes[d[1]+d[3]]||m.firstChild,c=d[2]-1;c>=0;c--)f=m.childNodes[d[1]+c],h?m.insertBefore(f,h):m.appendChild(f),h=f}},this)},hierarchicalAppend:function(a,b,c){return a instanceof Node?this.hierarchicalAppendChildren([a],b,c):this.inherited(a,b,c)},hierarchicalAppendString:function(b,c,d){var e=this.inherited(b,c,d);return e===a.Object.IDLE_RESOURCE?this.hierarchicalAppendHtml(b,c,d):void 0},hierarchicalAppendNumber:function(a,b,c){return this.hierarchicalAppendHtml(a,b,c)},hierarchicalAppendHtml:function(a,b,c){var d=this;b=b||d;var e=document.createElement("div");e.innerHTML=a;var f=Array.prototype.slice.call(e.childNodes);return d.hierarchicalAppendChildren(f,b,c)},hierarchicalUpdateEvent:function(a,b,c){return"capture"===a?this.hierarchicalUpdateCapture(b,c):this.inherited(a,b,c)},hierarchicalUpdateCapture:function(b,d){var e=this,f=new a.Object;if(b=c.getBindingIfString(b)||b,a.is(b,a.binding))f.retain(a.Object.binding(d,b,function(a){f.release("recursive"),f.retain("recursive",e.hierarchicalUpdateCapture(a,d))}));else if(a.is(b,a.Object))f.retain(this.hierarchicalUpdateCaptureObject(b,d));else{var g,h=[];a.each(b,function(a,b){"start"===b?g=a:(h.push(b),b=b.split(" ").map(function(a){return"capture"+a}).join(" "),f.retain(e.hierarchicalUpdateEvent(b,a,d)))}),h.length&&(h=h.join(" ").split(" "),f.retain(e.hierarchicalUpdateEvent("mousedown touchstart",function(b,c){c.capture(b,h),g&&("string"==typeof g?a.path(d,g).call(d,b,c):g.call(d,b,c))},d)))}return f},hierarchicalUpdateCaptureObject:function(b,c){var d=this,e=new a.Object,g=new a.List;return a.each(f.CAPTURES,function(a){
var f=b[a];f&&"function"==typeof f&&("property"===f.__type__?e.retain(a+"-watch",b.watch(a,function(a,f){"function"==typeof f?(e.retain(a,d.hierarchicalUpdateEvent("capture"+a,f.bind(b),c)),g.toggle(a,!0)):(e.release(a),g.toggle(a,!1))})):(e.retain(a,d.hierarchicalUpdateEvent("capture"+a,f.bind(b),c)),g.toggle(a,!0)))}),e.retain(g.watch("length",function(f,h){h?e.retain("start",d.hierarchicalUpdateEvent("mousedown touchstart",function(d,e){e.capture(d,g.toArray());var f=a.path(b,"start");f&&f.call(c,d,e)},c)):e.release("start")})),e},hierarchicalUpdateAttributes:function(b,c){var d=this,e=new a.Object;return a.each(b,function(a,b){"class"===b?e.retain(d.hierarchicalUpdateClass(a,c)):"style"===b?e.retain(d.hierarchicalUpdateStyles(a,c)):e.retain(d.hierarchicalUpdateAttribute(b,a,c))}),e},hierarchicalUpdateAttribute:function(b,d,e){var f=this;if(e=e||f,d=c.getBindingIfString(d)||d,a.is(d,a.binding)){var g=new a.Object;return g.retain(a.Object.binding(e,d,function(a){g.release("recursive"),g.retain("recursive",f.hierarchicalUpdateAttribute(b,a,e))})),g}return d||""===d?f.setAttribute(b,d||""):f.removeAttribute(b),a.Object.IDLE_RESOURCE},hierarchicalUpdateClass:function(b,d){var e=this;if(d=d||e,a.is(b,a.binding))return e.hierarchicalUpdateClassBinding(b,d);var f=new a.Object;return a.is(b,"String")?a.each(b.split(" "),function(a){var b=c.getStringBindingByString(a);b?f.retain(e.hierarchicalUpdateClassBinding(b,d)):f.retain(e.hierarchicalUpdateClassValue(a,d))}):a.is(b,"Array")&&a.each(b,function(a){f.retain(e.hierarchicalUpdateClass(a,d))}),f},hierarchicalUpdateClassValue:function(a,b){var c=this;return b=b||c,a&&c.addClass(a),{release:function(){a&&c.removeClass(a),a=null}}},hierarchicalUpdateClassBinding:function(b,c){var d=this;c=c||d;var e=(d.dom(),new a.Object);return e.retain(a.Object.binding(c,b,function(a){e.release("recursive"),a&&e.retain("recursive",d.hierarchicalUpdateClass(a,c))})),e},hierarchicalUpdateStyles:function(b,d){var e=this;b=c.getBindingIfString(b)||b;var f;return a.is(b,a.binding)?(f=new a.Object,f.retain(a.Object.binding(d,b,function(a){f.release("recursive"),a&&f.retain("recursive",e.hierarchicalUpdateStyles(a,d))}))):"string"==typeof b?f=a.Object.IDLE_RESOURCE:(f=new a.Object,a.each(b,function(a,b){f.retain(e.hierarchicalUpdateStyle(b,a,d))})),f},hierarchicalUpdateStyle:function(b,d,e){var f=this;return e=e||f,d=c.getBindingIfString(d)||d,a.is(d,a.binding)?f.hierarchicalUpdateStyleBinding(b,d,e):f.hierarchicalUpdateStyleValue(b,d,e)},hierarchicalUpdateStyleValue:function(a,b,c){var d=this;c=c||d;var e=d.hasStyle(a)?d.getStyle(a):null;return d.setStyle(a,b),{release:function(){e?d.setStyle(a,e):d.removeStyle(a)}}},hierarchicalUpdateStyleBinding:function(b,c,d){var e=this;d=d||e;var f=new a.Object;return f.retain(a.Object.binding(d,c,function(a){f.release("recursive"),f.retain("recursive",e.hierarchicalUpdateStyle(b,a,d))})),f}},statics:{CAPTURES:["tap","dragstart","dragmove","dragend","transform","hold","end"],CSS:a.util.csssheet.create({"nx-element":{display:"block"}})}})}(nx),function(a){var b=a.ui.Element;a.define("nx.ui.Template",{properties:{parent:{},list:{},template:{},context:{}},methods:{init:function(b,c,d,e){this.inherited(),this.parent(b),this.list(c),this.template(d),this.context(e),this.retain(a.Object.cascade(this,"parent,list,template,context",function(a,b,c,d){b&&(this.release("target-list"),this.retain("target-list",b.monitorContaining(function(a){return function(){a.release()}}))),a&&b&&c&&(d=d||a,this.retain("initial",this.applyBinding(a,b,c.binding,c.pattern,d)))}))},applyBinding:function(b,c,d,e,f){var g=this,h=new a.Object;return h.retain(a.Object.binding(f,d,function(i){h.release("recursive"),a.is(i,a.binding)?h.retain("recursive",g.applyTemplate(b,c,d,e,f)):a.is(i,a.List)?h.retain("recursive",g.applyList(b,c,i,e,f)):a.is(i,"Array")&&h.retain("recursive",g.applyList(b,c,new a.List(i),e,f))})),h},applyList:function(c,d,e,f,g){g=g||c;var h=a.List.mapeach(e,"model",{count:"list.length",parent:function(){return c},list:function(){return d},context:function(){return g},views:a.binding("parent, context, list, model",function(c,d,e,g){if(c&&d&&e){var h=this;this.release("views");var i=new a.Object;return this.retain("views",i),f.map(function(a){var d=b.create(c,a);return b.extendProperty(d,"scope",h),d.retain(b.update(d,a,d)),i.retain(d),d})}})});return h.retain(h.monitorDiff(function(b){var c=[];a.each(b.diffs,function(a){var b=a.slice();switch(b[0]){case"splice":b[1]*=f.length,b[2]*=f.length,b[3]=b[3].reduce(function(a,b){return a.concat(b.views())},[]);break;case"move":b[1]*=f.length,b[2]*=f.length,b[3]*=f.length}c.push(b)}),d.differ(c)})),h}}})}(nx),function(a){a.define("nx.ui.tag.Image",a.ui.Element,{methods:{init:function(){this.inherited("img")}},statics:{load:function(b,c){var d=new a.Object,e=document.createElement("img");return e.onload=function(){c&&c({success:!0,image:e,size:{width:e.width,height:e.height}})},e.onerror=function(){c&&c({success:!1,image:e})},e.src=b,d.retain({release:function(){c=null}}),d}}})}(nx),function(a){a.define("nx.ui.tag.Form",a.ui.Element,{methods:{init:function(){this.inherited("form")}}})}(nx),function(a){a.define("nx.ui.tag.Label",a.ui.Element,{methods:{init:function(){this.inherited("label")}}})}(nx),function(a){a.define("nx.ui.tag.HyperLink",a.ui.Element,{methods:{init:function(){this.inherited("a")}}})}(nx),function(a){a.define("nx.ui.tag.Input",a.ui.Element,{methods:{init:function(){this.inherited("input")},focus:function(){return this.dom().focus()},blur:function(){return this.dom().blur()}}})}(nx),function(a){a.define("nx.ui.tag.InputFile",a.ui.tag.Input,{view:{attributes:{type:"file"},events:{change:function(a,b){this.value(this.dom().value)}}},properties:{value:""}})}(nx),function(a){a.define("nx.ui.tag.InputCheckBox",a.ui.tag.Input,{view:{attributes:{type:"checkbox"}}})}(nx),function(a){a.define("nx.ui.tag.InputRadio",a.ui.tag.Input,{view:{attributes:{type:"radio"}}})}(nx),function(a){a.define("nx.ui.tag.InputButton",a.ui.tag.Input,{view:{attributes:{type:"button"}}})}(nx),function(a){a.define("nx.ui.tag.InputHidden",a.ui.tag.Input,{view:{attributes:{type:"hidden"}}})}(nx),function(a){a.define("nx.ui.tag.TextArea",a.ui.Element,{methods:{init:function(){this.inherited("textarea")}}})}(nx),function(a){a.define("nx.ui.tag.TableHeadCell",a.ui.Element,{methods:{init:function(){this.inherited("th")}}})}(nx),function(a){a.define("nx.ui.tag.TableCell",a.ui.Element,{methods:{init:function(){this.inherited("td")}}})}(nx),function(a){a.define("nx.ui.tag.TableRow",a.ui.Element,{methods:{init:function(){this.inherited("tr")}},properties:{childDefaultType:{value:function(){return a.ui.tag.TableCell}}}})}(nx),function(a){a.define("nx.ui.tag.Table",a.ui.Element,{methods:{init:function(){this.inherited("table")}},properties:{childDefaultType:{value:function(){return a.ui.tag.TableRow}}}})}(nx),function(a){a.define("nx.ui.tag.Span",a.ui.Element,{methods:{init:function(){this.inherited("span")}}})}(nx),function(a){a.define("nx.ui.tag.Canvas",a.ui.Element,{methods:{init:function(){this.inherited("canvas")}}})}(nx),function(a){a.define("nx.ui.tag.Source",a.ui.Element,{methods:{init:function(){this.inherited("source")}}})}(nx),function(a){a.define("nx.ui.tag.Audio",a.ui.Element,{view:{content:{repeat:"sources",type:"nx.ui.tag.Source",attributes:{src:a.binding("scope.model.src"),type:a.binding("scope.model.type")}}},properties:{sources:{}},methods:{init:function(){this.inherited("audio")},play:function(){this.dom().play()},pause:function(){this.dom().pause()}}})}(nx),function(a){a.define("nx.ui.tag.Video",a.ui.Element,{methods:{init:function(){this.inherited("video")},play:function(){this.dom().play()},pause:function(){this.dom().pause()}}})}(nx),function(a){a.define("nx.ui.tag.HorizontalRule",a.ui.Element,{methods:{init:function(){this.inherited("hr")}}})}(nx),function(a){var b=a.define("nx.lib.DefaultApplication",a.ui.Element,{properties:{size:{watcher:function(b,c){this.release("size"),c&&this.retain("size",a.ready(function(){var b=this.getGlobalFontSizeByPageSize(c);b?(a.util.cssstyle.set(document.documentElement,"font-size",b+"px"),this.setStyle("font-size",b+"px")):(a.util.cssstyle.remove(document.documentElement,"font-size"),this.removeStyle("font-size"))}.bind(this)))}}},methods:{init:function(){this.inherited("nx-app"),this.retain(this.syncViewScale()),b.CSS_GLOBAL||(b.CSS_GLOBAL=a.util.csssheet.create({html:{height:"100%"},body:{margin:"0",padding:"0",height:"100%",color:"#b3b3b3","font-family":"'Roboto'","user-select":"none"}}))},syncViewScale:function(){var a=this,b=function(b){a.size({width:global.innerWidth,height:global.innerHeight})};return global.addEventListener("resize",b),this.size({width:global.innerWidth,height:global.innerHeight}),{release:function(){global.removeEventListener("resize",b)}}},getGlobalFontSizeByPageSize:function(a){return 0}}})}(nx),function(a){a.define("nx.lib.thread.Thread",{properties:{worker:null},methods:{init:function(a){this.inherited();var b=this.worker(new Worker(a));b.onmessage=function(a){this.fire("message",a.data)}.bind(this)},send:function(a){this.worker().postMessage(a)}}})}(nx),function(a){a.define("nx.lib.svg.AbstractNode",a.ui.Element,{properties:{childDefaultType:{value:function(){return a.lib.svg.Node}},graph:null,fill:{value:"inherit",watcher:function(a,b){b&&"inherit"!=b?this.setStyle("fill",b):this.removeStyle("fill")}},fillComputed:{dependencies:"fill,parentNode.strokeComputed",value:function(a,b){return a&&"inherit"!=a?a:b||"black"}},stroke:{value:"inherit",watcher:function(a,b){b&&"inherit"!=b?this.setStyle("stroke",b):this.removeStyle("stroke")}},strokeComputed:{dependencies:"stroke,parentNode.strokeComputed",value:function(a,b){return a&&"inherit"!=a?a:b||"black"}},strokeWidth:{value:"inherit",watcher:function(a,b){b&&"inherit"!=b?this.setStyle("stroke-width",b):this.removeStyle("stroke-width")}},strokeWidthComputed:{dependencies:"strokeWidth,parentNode.strokeWidthComputed",value:function(a,b){return a>=0?a:b||0}}},methods:{hierarchy:function(){for(var a=[this],b=this.parentNode();b;)a.unshift(b),b=b.parentNode();return a}},statics:{cssTransformMatrix:function(a){if(!a)return"";var b=[a[0][0],a[0][1],a[1][0],a[1][1],a[2][0],a[2][1]].join(",").replace(/-?\d+e[+-]?\d+/g,"0");return"matrix("+b+")"}}})}(nx),function(a){a.define("nx.lib.svg.SvgDefs",a.lib.svg.AbstractNode,{methods:{init:function(){this.inherited("defs","http://www.w3.org/2000/svg")}},properties:{graph:{dependencies:"parentNode.graph"}}})}(nx),function(a){var b=a.define("nx.lib.svg.Svg",a.lib.svg.AbstractNode,{view:{content:{name:"defs",type:"nx.lib.svg.SvgDefs"}},properties:{graph:{value:function(){return this}},naturalTerminal:{value:!1}},methods:{init:function(){this.inherited("svg","http://www.w3.org/2000/svg")},getWidth:function(){return this.$dom.offsetWidth},getHeight:function(){return this.$dom.offsetHeight},serialize:function(a){return b.serialize(this.dom(),a)}},statics:{getSvgSize:function(a){var b=a.getAttribute("width"),c=a.getAttribute("height"),d=a.getAttribute("viewBox");return b&&(b=1*b.replace(/[^-.0123456789]/g,"")),c&&(c=1*c.replace(/[^-.0123456789]/g,"")),d&&(d=d.split(" "),b=b||1*d[2]||0,c=c||1*d[3]||0),{width:b||0,height:c||0}},serialize:function(a,b){var c=new XMLSerializer,d=c.serializeToString(a);return b!==!1?"data:image/svg+xml;utf8,"+d:d}}});a.util.csssheet.create({svg:{stroke:"black",fill:"transparent"},"svg text":{"user-select":"none"}})}(nx),function(a){var b=a.geometry,c=a.define("nx.lib.svg.Node",a.lib.svg.AbstractNode,{mixins:[a.geometry.MatrixSupport],properties:{graph:{dependencies:"parentNode.graph"},cssTransform:{dependencies:"matrix",value:function(a){return a?c.cssTransformMatrix(a):void 0},watcher:function(a,b){b&&("matrix(1,0,0,1,0,0)"!=b||this.hasStyle("transform"))&&this.setStyle("transform",b)}},naturalTerminal:{value:!1},naturalMatrix:{dependencies:"parentNode.naturalTerminal, parentNode.naturalMatrix, matrix",value:function(a,c,d,e){a&&0==e.indexOf("parentNode.")||(c&&d?this.naturalMatrix(b.Matrix.multiply(d,c)):d&&this.naturalMatrix(d||c||b.Matrix.I))}},naturalMatrix_internal_:{dependencies:"naturalMatrix",value:function(a){return a&&new b.Matrix(a)}},naturalPosition:{dependencies:"naturalMatrix",value:function(a){return a&&[a[2][0],a[2][1]]||[0,0]}},naturalRotate:{dependencies:"naturalMatrix_internal_.rotate"},naturalScale:{dependencies:"naturalMatrix_internal_.scale"}},methods:{init:function(a){this.inherited(a||"g","http://www.w3.org/2000/svg")},applyNatureTranslate:function(a,c){var d=(this.parentNode(),[[1,0,0],[0,1,0],[a,c,1]]);this.matrix(b.Matrix.multiply(this.naturalMatrix_internal_().getMatrixInversion(),d,this.naturalMatrix(),this.matrix()))}},statics:{cssTransformMatrix:function(a){var b=[a[0][0],a[0][1],a[1][0],a[1][1],a[2][0],a[2][1]].join(",").replace(/-?\d+e[+-]?\d+/g,"0");return"matrix("+b+")"}}})}(nx),function(a){a.define("nx.lib.svg.Use",a.lib.svg.Node,{properties:{href:{watcher:function(a,b){b&&this.setAttributeNS("http://www.w3.org/1999/xlink","href",b)}}},methods:{init:function(a){this.inherited(a||"use","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.shape.Text",a.lib.svg.Node,{methods:{init:function(){this.inherited("text")}},view:{properties:{"class":"text"}},properties:{text:{value:"",watcher:function(a,b){this.release("text"),this.retain("text",this.append(b))}},textAnchor:{value:"middle",watcher:function(a,b){this.setAttribute("text-anchor",b)}}},statics:{CSS:a.util.csssheet.create({"svg text":{stroke:"none"}})}})}(nx),function(a){a.define("nx.lib.svg.shape.Line",a.lib.svg.Node,{view:{attributes:{x1:"0",y1:"0"}},properties:{dx:{value:0,watcher:function(a,b){b||0===b||(b=""),this.setAttribute("x2",b)}},dy:{value:0,watcher:function(a,b){b||0===b||(b=""),this.setAttribute("y2",b)}}},methods:{init:function(){this.inherited("line")}}})}(nx),function(a){a.define("nx.lib.svg.shape.Rectangle",a.lib.svg.Node,{properties:{center:{value:!1},width:{value:0},height:{value:0},bound_internal_:{dependencies:"center, width, height",value:function(a,b,c){var d,e,f,g;return f=Math.abs(b),g=Math.abs(c),a?(d=-f/2,e=-g/2):(d=0>b?b:0,e=0>c?c:0),[d,e,f,g]},watcher:function(b,c){c&&a.each(["x","y","width","height"],function(a,b){c[b]?this.setAttribute(a,c[b]):this.removeAttribute(a)}.bind(this))}},rx:{value:0,watcher:function(a,b){b?this.setAttribute("rx",b):this.removeAttribute("rx")}},ry:{value:0,watcher:function(a,b){b?this.setAttribute("ry",b):this.removeAttribute("ry")}}},methods:{init:function(){this.inherited("rect")}}})}(nx),function(a){a.define("nx.lib.svg.shape.Circle",a.lib.svg.Node,{properties:{center:{value:!0},radius:{value:10,watcher:function(a,b){this.setAttribute("r",b||"0")}},centralize_internal_:{dependencies:"center, radius",async:!0,value:function(a,b,c){b?(this.setAttribute("cx",0),this.setAttribute("cy",0)):(this.setAttribute("cx",c),this.setAttribute("cy",c))}}},methods:{init:function(){this.inherited("circle")}}})}(nx),function(a){a.define("nx.lib.svg.shape.Path",a.lib.svg.Node,{methods:{init:function(){this.inherited("path")}},properties:{vectors:{value:[]},d:{dependencies:"vectors",value:function(a){if(a&&a.length){var b="M 0 0";do v=a.shift(),b+=" l "+v[0]+" "+v[1];while(a.length);return b}return this._d||"M 0 0"},watcher:function(a,b){this.setAttribute("d",b)}}}})}(nx),function(a){a.define("nx.lib.svg.shape.PathGroup",a.lib.svg.Node,{view:{content:a.template({source:"data",pattern:{type:"nx.lib.svg.shape.Path",properties:{d:a.binding("scope.model.d"),fill:a.binding("scope.model.fill"),stroke:a.binding("scope.model.stroke")}}})},properties:{data:{}}})}(nx),function(a){var b=a.geometry.Vector,c=b.multiply,d=b.rotate,e=b.abs,f=b.plus,g=Math.sqrt(5)/2-.5;a.define("nx.lib.svg.shape.PathLine",a.lib.svg.shape.Path,{properties:{operationsUpdater_internal_:{dependencies:"dx, dy, dh",async:!0,value:function(a,b,h,i){if(i){var j=[b,h],k=d(e([b,h],i),Math.PI/2),l=f(c(j,.5),k),m="M 0 0";m+=" "+["C"].concat(f(c(k,g),c(j,1/6))).concat(f(k,c(j,1/3))).concat(l).join(" "),m+=" "+["C"].concat(f(k,c(j,2/3))).concat(f(c(k,g),c(j,5/6))).concat(j).join(" "),this.d(m)}else this.vectors([[b,h]])}},dx:{value:100},dy:{value:0},dh:{value:0}}})}(nx),function(a){var b=a.geometry,c=b.Vector,d=c.rotate,e=c.abs,f=c.multiply,g=(c.plus,function(a,b,c){return a=f(a,b),c&&(a=d(a,c)),a}),h=Math.PI,i=(Math.abs,b.Math.sin),j=(b.Math.cos,b.Math.tan),k=b.Math.cot,l=h/2;a.define("nx.lib.svg.shape.Arrow",a.lib.svg.shape.PathLine,{properties:{stroke:{watcher:function(a,b){b&&"inherit"!=b&&this.set("fill",b)}},strokeWidth:{value:"inherit",watcher:a.idle},fill:{watcher:a.idle},operationsUpdater_internal_:{dependencies:"strokeWidthComputed,dx,dy,dh,sharpness,concavity",async:!0,value:function(a,b,c,d,f,m,n){var o=[];n=n||h;var p=[c,d],q=e(p,1),r=e(p),s=b,t=m/2,u=n/2,v=s/2,w=r-v*(2*k(t)-k(u));m>0&&h>=m&&4*v/r<j(t)?(o.push(g(q,v,l)),o.push(g(q,w)),o.push(g(q,v/i(u),h-u)),o.push(g(q,s/i(t),-t)),o.push(g(q,s/i(t),h+t)),o.push(g(q,v/i(u),u)),o.push(g(q,-w)),o.push(g(q,v,l))):(o.push(g(q,v,l)),o.push([c,d]),o.push(g(q,2*v,-l)),o.push([-c,-d]),o.push(g(q,v,l))),this.vectors(o)}},sharpnessDeg:{value:30},sharpness:{dependencies:"sharpnessDeg",value:function(a){return a?a*h/180:h/6}},concavityDeg:{value:0},concavity:{dependencies:"concavityDeg",value:function(a){return a?a*h/180:h}}},methods:{init:function(a){this.inherited(a),this.set("stroke-width",0)}}})}(nx),function(a){a.define("nx.lib.svg.filter.Filter",a.lib.svg.AbstractNode,{properties:{graph:{dependencies:"parentNode.graph"}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeBlend",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feBlend","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeColorMatrix",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feColorMatrix","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeComponentTransfer",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feComponentTransfer","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeComposite",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feComposite","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeConvolveMatrix",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feConvolveMatrix","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeDiffuseLighting",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feDiffuseLighting","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeDisplacementMap",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feDisplacementMap","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeDistantLight",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feDistantLight","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeFlood",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feFlood","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeGaussianBlur",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feGaussianBlur","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeImage",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feImage","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeMerge",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feMerge","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeMorphology",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feMorphology","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeOffset",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feOffset","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FePointLight",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("fePointLight","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeSpecularLighting",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feSpecularLighting","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeSpotLight",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feSpotLight","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeTile",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feTile","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeTurbulence",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feTurbulence","http://www.w3.org/2000/svg")}}})}(nx),function(a){var b=2,c="y",d=a.define("nx.lib.component.Scroller",a.ui.Element,{view:{cssclass:"scroller",content:{name:"inner"},capture:{start:"handler_dragstart",drag:"handler_dragmove",dragend:"handler_dragend"},events:{axis:"option_axis"}},properties:{pageSize:1,axis:c,elastic:2e3},methods:{init:function(b){this.inherited(),a.sets(this,b),this._x=this._y=0},isScrollable:function(a){var b=this.axis()||c;return 0==arguments.length?"x"==b||"y"==b:a==b},getLimit:function(){var a,b=this.axis(),c=0;return c=Math.min(0,this._out[b]-this._in[b]),a=this.pageSize(),c&&a>1&&(c=Math.ceil(c/a)*a),c},delta:function(a){if(!this.isScrollable())return 0;var c=this.axis(),d=this.getLimit(c),e=this["_"+c];return e>0?e*b+a>0?a/b:d>2*e+a?(a-d)/b+d:e*b+a-e:0>e-d?0>(e-d)*b+a?a/b:(e-d)*b+a>-d?(a+d)/b-d:a-(b-1)*(d-e):e+a>0?(a-e)/2:d>e+a?(a-e+d)/2:a},freemove:function(a){if(!this.isScrollable())return!1;var c,d,e,f,g,h,i,j,k,l,m,n,o=this.axis(),p=this;c=this.elastic(),d=this.getLimit(),e=this["_"+o],e>0||d>e?(f=e>0?-e:d-e,g=Math.sqrt(Math.abs(2*f/c/b)),h="(0.5, 1, 1, 1)"):(g=Math.abs(a/c),f=a*g/2,i=e+f,0>=i&&i>=d?h="(0, 1, 1, 1)":(f=i>0?-e:d-e,j=(a>=0?1:-1)*Math.sqrt(a*a-2*c*f),k=Math.abs((a-j)/c),l=Math.abs(j/b/c),g=k+2*l,m=j*l/2,n=f+2*m,h="("+(k+l)/g+","+n/f+","+(k+1.5*l)/g+", 1)")),g>1&&(g=1),this.animate(g,h),this["_"+o]+=f,this.translate(this._x,this._y),setTimeout(function(){var a=p.pageSize()||1,b=p["_"+o];b%a?(p["_"+o]=Math.round(b/a)*a,p.animate(.15,"(0.5, 1, 1, 1)"),p.translate(p._x,p._y),setTimeout(function(){p.animate(!1)},150)):p.animate(!1)},1e3*g+10)},option_axis:function(){this.reset()},update:function(){var a=this.inner().getBound(),b=this.getBound();this._in={x:a.width,y:a.height},this._out={x:b.width,y:b.height}},reset:function(){this._x=0,this._y=0,this.translate(this._x,this._y)},fixbound:function(){this.update(),this.freemove(0)},handler_dragstart:function(a,b){this.update(),this.animate(!1)},handler_dragmove:function(a,b){if(this.isScrollable()){var c=this.axis();this["_"+c]+=this.delta(b.capturedata.delta["x"==c?0:1]),this.translate(this._x,this._y)}},handler_dragend:function(a,b){if(this.isScrollable()){var c=d.getSpeed(b.capturedata.track),e=this.axis();this.freemove(c[e])}},translate:function(a,b){this.inner().setStyle("transform","translate("+a+"px, "+b+"px)"),this.inner().setStyle("transform","translate3d("+a+"px, "+b+"px, 0)")},animate:function(a,b){if(a===!1)this.inner().removeStyle("transition-duration"),this.inner().removeStyle("transition-timing-function");else{var c=a+"s";this.inner().setStyle({"transition-duration":c,"transition-timing-function":"cubic-bezier"+b})}}},statics:{DEFAULT_AXIS:c,getSpeed:function(a){var b={x:1e3*(a[a.length-1][0]-a[0][0])/Math.max(1,a[a.length-1].time-a[0].time),y:1e3*(a[a.length-1][1]-a[0][1])/Math.max(1,a[a.length-1].time-a[0].time)};return Math.abs(a[a.length-1][0]-a[0][0])<40?b.x=0:Math.abs(b.x)<1200&&(b.x=1200*(b.x>0?1:-1)),Math.abs(a[a.length-1][1]-a[0][1])<40?b.y=0:Math.abs(b.y)<1200&&(b.y=1200*(b.y>0?1:-1)),a[a.length-1].time-a[0].time>300&&(b.x=b.y=0),b}}})}(nx),function(a){a.define("nx.lib.component.FileLabel",a.ui.tag.Label,{view:{attributes:{"for":a.binding("name"),"class":["nx-file-label",a.binding("disabled",function(a){return a?"disabled":!1})]},content:[{name:"input",type:"nx.ui.tag.InputFile",attributes:{id:a.binding("name"),name:a.binding("name"),accept:a.binding("accept"),disabled:a.binding("disabled",function(a){return a?"disabled":!1})},events:{change:function(){this.fire("change",this.input().dom())}}}]},properties:{name:"",accept:"",disabled:!1}})}(nx),function(a){a.define("nx.lib.component.NormalInput",a.ui.Element,{view:{attributes:{"class":["nx-normal-input"]},content:{name:"input",type:"nx.ui.tag.Input",attributes:{value:a.binding("value",!0,function(a,b){b!==this.input().value&&(this.input().value=b)}),id:a.binding("id"),name:a.binding("name"),placeholder:a.binding("placeholder"),type:a.binding("password",function(a){return a?"password":"text"})},events:{input:function(a,b){this.value(this.input().dom().value),this.fire("input",b)}}}},properties:{id:null,value:null,name:null,placeholder:null,password:!1},methods:{focus:function(){this.input().dom().focus()},blur:function(){this.input().dom().blur()}},statics:{CSS:a.util.csssheet.create({".nx-normal-input":{position:"relative",overflow:"hidden"},".nx-normal-input > input":{position:"absolute",background:"transparent",left:"0",top:"0",width:"100%",height:"100%",outline:"none",border:"0","border-radius":"inherit","text-indent":"inherit","font-size":"inherit","font-weight":"inherit"}})}})}(nx),function(a,b,c,d,e){var f=10,g=a.define("nx.lib.component.CommonContenteditable",a.ui.Component,{events:["common_contenteditable_change","common_contenteditable_caret","common_contenteditable_keydown"],properties:{textHTML:{get:function(){return this.dom().innerHTML}},textPlain:{get:function(){return g.dom.plainate(this.dom()).text},set:function(a){a=a||"";for(var b;this.dom().firstChild;)this.dom().removeChild(this.dom().firstChild);b=document.createTextNode(a),this.dom().appendChild(b),this.notify("textPlain"),this._caret={node:b,text:a,offset:a?a.length:0},this.fire("common_contenteditable_change")}},caret:{get:function(){return this._caret||(this._caret={node:this.dom(),text:"",offset:0}),this._caret}},captureKeyCodeList:{value:[]}},view:{properties:{spellcheck:"false",tabindex:0,contenteditable:"true"},events:{input:"{#_handle_input}",keydown:"{#_handle_keydown}",keypress:"{#_handle_keypress}",focus:"{#_handle_focus_on}",blur:"{#_handle_focus_off}",mouseup:"{#_handle_mouseup}",click:"{#_handle_click}"}},methods:{empty:function(){this.inherited(arguments),this._caret=null,this.fire("common_contenteditable_change")},displace:function(a){var b,c,d,e,f=this.dom(),h=this._caret||{node:f,text:"",offset:0},i=a.value;h.node===f?h.offset==f.childNodes.length?"string"==typeof i?(c=document.createTextNode(i),f.appendChild(c),this.collapse(c,i.length)):g.is.element(i)&&(i.setAttribute("contenteditable","false"),f.appendChild(i),this.collapse(f,offset+1)):(d=f.childNodes[h.offset],"string"==typeof i?(c=document.createTextNode(i),f.insertBefore(c,d),this.collapse(c,i.length)):g.is.element(i)&&(i.setAttribute("contenteditable","false"),f.insertBefore(i,d),this.collapse(f,offset+1))):g.is.text(h.node)&&(e=a.deltaArea?a.deltaArea.slice():[0,0],e[0]+=h.offset,e[1]+=h.offset,"string"==typeof i?(b=h.text.substring(0,e[0])+i+h.text.substring(e[1]),h.node.textContent=b,this.collapse(h.node,e[0]+i.length)):g.is.element(i)&&(i.setAttribute("contenteditable","false"),b=h.text,e[0]>0?f.insertBefore(document.createTextNode(b.substring(0,e[0])),d):g.is.element(d.previousSibling)&&f.insertBefore(c=document.createTextNode(" "),d),f.insertBefore(i,d),e[1]<b.length?(c=document.createTextNode(b.substring(e[1])),f.insertBefore(c,d),f.removeChild(d),this.collapse(c,0)):(c=document.createTextNode("‍"),f.insertBefore(c,d),f.removeChild(d),this.collapse(c,0)))),g.dom.purify(this.dom()),this.fire("common_contenteditable_change")},detector:function(a){a?this._timer_detector||(this._timer_detector=setInterval(function(){this._lock_detector||this.updateCaret()}.bind(this),f)):this._timer_detector&&(clearInterval(this._timer_detector),this._timer_detector=!1)},collapse:function(a,b){window.getSelection().collapse(a,b),this.updateCaret()},updateCaret:function(){(function(){if("firefox"==a.Env.browser().name){var b=window.getSelection(),c=b.isCollapsed&&b.focusNode,d=b.isCollapsed&&b.focusOffset;g.is.text(c)&&c===this.dom().lastChild&&d==c.textContent.length&&(/\s$/.test(c.textContent)?window.getSelection().collapse(c,d-1):(c.textContent+=" ",window.getSelection().collapse(c,d)))}}).call(this);var b=window.getSelection().getRangeAt(0),c=b.startContainer,d=g.dom.plainate(c),e=this._caret&&this._caret.node,f=this._caret&&this._caret.text,h=this._caret&&this._caret.offset,i=this._caret&&this._caret.range;(e!==c||h!==d.offset||f!==d.text||i!==d.range)&&(this._caret={node:c,text:d.text,offset:d.offset,range:d.range},this.fire("common_contenteditable_caret",{node:c,text:d.text,offset:d.offset,range:d.range}))},_handle_input:function(){this._lock_detector=!0,setTimeout(function(){g.dom.purify(this.dom()),this.updateCaret(),this.fire("common_contenteditable_change"),this._lock_detector=!1}.bind(this),5)},_handle_focus_on:function(){this.detector(!0)},_handle_focus_off:function(){this.detector(!1)},_handle_keypress:function(a,b){b.stopPropagation()},_handle_keydown:function(a,b){var c,d=this.captureKeyCodeList();for(c=0;c<d.length;c++){if(b.which==d[c]){this.fire("common_contenteditable_keydown",b);break}if(13==b.which){b.preventDefault(),b.stopPropagation();break}}},_handle_mouseup:function(a,b){"A"==b.target.tagName&&b.target.parentNode===this.dom()&&window.getSelection().collapse(this.dom(),g.dom.index(b.target)+1)},_handle_click:function(a,b){"A"==b.target.tagName&&b.target.parentNode===this.dom()&&b.preventDefault()}},statics:{is:{contain:function(a,b){for(;b.parentNode&&b.parentNode!==b;){if(a===b.parendNode)return!0;b=b.parentNode}return!1},text:function(a){return!!a&&!a.tagName},element:function(a){return!!a&&!!a.tagName}},dom:{index:function(a){for(var b=0;a.previousSibling;)b++,a=a.previousSibling;return b},plainate:function(a){for(var b,c=window.getSelection(),d=c.rangeCount?c.getRangeAt(0):{},e=function(a){var b="",c=-1,f=-1;if(g.is.text(a))b=a.textContent,d.startContainer===a&&(c=d.startOffset,d.endContainer===a&&(f=d.endOffset-d.startOffset));else if(g.is.element(a)){var h,i,j,k=a.childNodes.length;for(h=0;k>h;h++)i=a.childNodes[h],j=e(i),c>=0?b+=j.text:(j.offset>=0&&(c=b.length+j.offset,f=j.range),b+=j.text);d.startContainer===a&&(c=b.length,f=0)}return{text:b,offset:c,range:f}},f=e(a);(b=f.text.indexOf("‍"))>=0;)b<f.offset&&f.offset--,f.text=f.text.substring(0,b)+f.text.substring(b+1);return f},purify:function(b){function c(a,b){var c=window.getSelection(),d=c.isCollapsed&&c.focusNode,e=c.isCollapsed&&c.focusOffset,f=d===a?e:d===b?a.textContent.length+e:-1;a.textContent=a.textContent+b.textContent,f>=0&&c.collapse(a,f)}var d,e,f,h,i;for(e=b.childNodes.length,d=e-1;d>=0;d--)if(f=b.childNodes[d],!g.is.text(f)){if(g.is.element(f)){if(h=g.dom.plainate(f),"A"==f.tagName.toUpperCase()&&f.getAttribute("href")&&"false"==f.getAttribute("contenteditable"))continue;h.text&&(i=document.createTextNode(h.text),b.insertBefore(i,f),h.offset>=0&&window.getSelection().collapse(i,h.offset))}b.removeChild(f)}for(e=b.childNodes.length,d=e-1;d>=0;d--)f=b.childNodes[d],g.is.text(f)&&(h=g.dom.plainate(f),h.text?(f.textContent!==h.text&&(f.textContent=h.text),h.offset>=0&&window.getSelection().collapse(f,h.offset),g.is.text(f.nextSibling)&&(c(f,f.nextSibling),b.removeChild(f.nextSibling))):(b.removeChild(f),h.offset>=0&&window.getSelection().collapse(b,d)));if("chrome"==a.Env.browser().name){var j=window.getSelection(),k=j.isCollapsed&&j.focusNode,l=j.isCollapsed&&j.focusOffset;k===b&&g.is.element(b.lastChild)&&l==b.childNodes.length&&(f=document.createTextNode("‍"),b.appendChild(f),window.getSelection().collapse(b,l))}else"firefox"==a.Env.browser().name&&(f=document.createTextNode("‍"),
b.appendChild(f))}}}})}(nx,nx.position,nx.dom,nx.ui,window),function(a,b,c,d,e){var f=a.define("nx.lib.component.AutoComplete",a.ui.Element,{view:{attributes:{"class":"position-parent"},content:[{name:"input",type:"nx.lib.component.CommonContenteditable",attributes:{"class":"input form-control",tabindex:a.binding("tabindex"),contenteditable:a.binding("contenteditable")},events:{common_contenteditable_caret:"_handle_input_caret",common_contenteditable_keydown:"_handle_input_keydown",common_contenteditable_change:"_handle_input_change"}},{name:"list",attributes:{tabindex:0,"class":["list",a.binding("listVisibilityClass_internal_")],style:{position:"absolute"}},content:a.binding("listItemTemplate",function(b){return b?a.template({source:"listData",pattern:b}):void 0})}]},properties:{value:{get:function(){return this.input().textPlain()},set:function(a){this.input().textPlain(a),this.notify("value")}},contenteditable:{value:!0},tabindex:{value:-1},promptMode:{value:"input"},inputCaret_internal_:{value:null},inputCaretReplaceInfo_internal_:{value:a.binding({context:!0,source:"promptMode, inputCaret_internal_",callback:function(a,b){if(!b||b.offset<0||"string"!=typeof b.text)return null;var c=b.text,d=b.offset,e=b.range;(0>e||e+d>c.length)&&(e=c.length-d);var f,g=null,h=c.substring(0,d),i=(c.substring(d,d+e),c.substring(d+e));switch(a){case"select":g={keyword:h,deltaStart:-h.length,deltaEnd:c.length-h.length};break;case"caret":case"input":default:(!i||/^\s/.test(i))&&/^(.*\s)?([^\s]+)$/.test(h)&&(f=h.replace(/^(.*\s)?([^\s]*)$/,"$2"),g={keyword:f,deltaStart:-f.length,deltaEnd:e})}return g}})},inputFocus:{value:!1},inputCaptureKeyCodeList_internal_:{value:[],value:a.binding({context:!0,source:"listVisibility_internal_",callback:function(a){return a?f.captureKeyCodeList:[]}}),watcher:function(){this.input().captureKeyCodeList(this.inputCaptureKeyCodeList_internal_())}},listData:{value:[],watcher:function(){var a=this.list();setTimeout(function(){nxex.toolkit.collectionItemHandle(a.content(),function(a,b){b.dom().addClass("item");var c,d,e;return c=function(){this.listItemActivated(b)}.bind(this),d=function(){this.listItemActivated(null)}.bind(this),e=function(){this._executeSelection(b.template().model())}.bind(this),b.on("mouseenter",c),b.on("mouseleave",d),b.on("click",e),{release:function(){b.off("mouseenter",c),b.off("mouseleave",d),b.off("click",e)}}}.bind(this)).notify()}.bind(this),1)}},listDataKeyPath:{value:""},listDataFilter:{value:null},listDataSelector_internal_:{value:null,value:a.binding({context:!0,source:"listDataKeyPath,listDataFilter",callback:function(a,b){return b?b:f.selectorByPath(a)}})},listItemCountLimit:{value:0},listDataSelected_internal_:{value:[],value:a.binding({context:!0,source:"inputCaretReplaceInfo_internal_,listData,listDataSelector_internal_,listItemCountLimit",callback:function(a,b,c,d){if(!c)return[];var e=c.call(this,a,b);return e&&e.length>0&&d>0&&(e=e.slice(0,d)),e}}),watcher:function(){var b=this.list(),c=this.listDataSelected_internal_();c&&c.length&&a.each(b.content(),function(a){var b;for(b=0;b<c.length&&a.template().model()!==c[b];b++);a.dom().setClass("hidden",b>=c.length)}.bind(this))}},listItemActivated:{value:-1,get:function(){var a,b,c=this.list().content().toArray();for(a=0;a<c.length;a++)if(b=c[a],b.dom().hasClass("active"))return b;return null},set:function(a){var b,c,d=this.list().content().toArray();for(b=0;b<d.length;b++)c=d[b],a!==c||c.dom().hasClass("hidden")?c.dom().removeClass("active"):c.dom().addClass("active")},value:a.binding({context:!0,source:"listDataSelected_internal_",callback:function(a){var b=this.listItemActivated();return b&&b.dom().hasClass("hidden")?b:null}}),watcher:function(a,b){b&&this._scrollTo(b)}},listVisibility_internal_:{value:!0,value:a.binding({context:!0,source:"inputFocus,listDataSelected_internal_",callback:function(a,b){return b&&b.length&&a?!0:!1}}),watcher:function(){var a=this.promptMode();f.adjustListPosition(a,this,this.list())}},listVisibilityClass_internal_:{value:a.binding("listVisibility_internal_",function(a){return a?"":"hidden"})},listItemTemplate:{value:{content:a.binding("model")}},listDataSelectedItem:{value:null,value:a.binding({context:!0,source:"promptMode, listData, inputCaretReplaceInfo_internal_, listDataKeyPath",callback:function(b,c,d,e){var f=this.listDataSelectedItem(),g=this.value();if(c&&d)switch(b){case"select":var h,i,j,k=[];for(h=0;c&&h<c.length;h++)i=c[h],j=a.path(i,e),(j||"").toLowerCase()===(g||"").toLowerCase()&&k.push(i);f=1==k.length?k[0]:null}return f}}),watcher:function(){this.fire("execute_selection",this.listDataSelectedItem())}}},methods:{init:function(){this.inherited(),this.focusGroup=new nxex.common.FocusGroup,this.focusGroup.add(this.input()),this.focusGroup.add(this.list()),this.focusGroup.on("focus",this._handle_group_focus,this),this.focusGroup.on("blur",this._handle_group_blur,this)},clear:function(){this.input().empty(),this.fire("execute_change")},_scrollTo:function(a){var b=(this._getListItemIndex(a),this.list()),c=a.dom(),d=b.dom(),e=a.dom().getBound(),f=b.dom().getBound(),g=c.offsetHeight,h=e.top,i=d.clientHeight,j=f.top;d.scrollTop;h+g>j+i&&(d.scrollTop+=h+g-(j+i)),j>h&&(d.scrollTop-=j-h)},_executeSelection:function(b){var c=this.inputCaretReplaceInfo_internal_();if(c){var d=this.listDataKeyPath(),e=a.path(b,d);this.input().displace({deltaArea:[c.deltaStart,c.deltaEnd],value:e}),this.listDataSelectedItem(b)}},_getListItemIndex:function(a){var b,c,d=this.list().content().toArray();for(b=0;b<d.length;b++)if(c=d[b],c===a)return b;return-1},_getListItemRelative:function(a,b){var c,d=null,e=this.list().content().toArray();switch(b){case"previous-visible":for(c=this._getListItemIndex(a);--c>=0;)if(!e[c].dom().hasClass("hidden")){d=e[c];break}break;case"next-visible":for(c=this._getListItemIndex(a);++c<e.length;)if(!e[c].dom().hasClass("hidden")){d=e[c];break}break;case"first":case"last":case"first-visible":case"last-visible":case"previous":case"next":}return d},_handle_focus:function(){this.input().dom().focus()},_handle_group_focus:function(){this.inputFocus(!0),this.fire("focus")},_handle_group_blur:function(){this.inputFocus(!1),this.fire("blur")},_handle_input_caret:function(){this.inputCaret_internal_(this.input().caret())},_handle_input_change:function(){this.inputCaret_internal_(this.input().caret()),this.fire("execute_change")},_handle_input_keydown:function(a,b){var c;switch(b.which){case 13:this.listVisibility_internal_()&&(b.preventDefault(),c=this.listItemActivated(),c||(c=this._getListItemRelative(c,"next-visible")),c&&c.model()&&this._executeSelection(c.model()));break;case 38:this.listVisibility_internal_()&&(b.preventDefault(),c=this.listItemActivated(),c=this._getListItemRelative(c,"previous-visible"),c&&this.listItemActivated(c));break;case 40:this.listVisibility_internal_()&&(b.preventDefault(),c=this.listItemActivated(),c=this._getListItemRelative(c,"next-visible"),c&&this.listItemActivated(c))}}},statics:{captureKeyCodeList:[13,38,40],caretRect:function(){var a,b=window.getSelection();return b.rangeCount&&(a=b.getRangeAt(0).getClientRects()[0]),a&&(a={left:a.left,top:a.top,width:a.width,height:a.height}),a},adjustListPosition:function(a,b,c){var d=b.dom().offsetParent;if(d){var e,g=d.getBoundingClientRect(),h=d.scrollLeft,i=d.scrollTop;switch(a){case"caret":var e=f.caretRect();e.top+=i-g.top,e.left+=h-g.left,c.dom().setStyle("left",e.left),c.dom().setStyle("top",e.top+e.height);break;case"input":case"select":default:var e=b.dom().getBound();e.top+=i-g.top,e.left+=h-g.left,c.dom().setStyle("left",e.left),c.dom().setStyle("top",e.top+e.height),c.dom().setStyle("width",e.width)}}},selectorByPath:function(b){function c(c){var d,e,f=[];for(d=0;d<c.length;d++)e=c[d],f.push(a.path(e,b));return f}function d(a,b){return b&&0==b.toLowerCase().replace(/\s/g,"").indexOf(a.toLowerCase().replace(/\s/g,""))&&b.length>a.length}return function(a,b){var e,f,g=[];if(a)for(f=c(b),keyword=a.keyword,e=0;e<b.length;e++)d(keyword,f[e])&&g.push(b[e]);return g}}}})}(nx,nx.position,nx.dom,nx.ui,window),function(a){a.define("nx.lib.component.CentralizedImage",a.ui.Element,{view:{attributes:{"class":["nx-centralized-image"]},content:{name:"image",type:"nx.ui.tag.Image",attributes:{src:a.binding("src")},events:{load:function(){var a=this.image(),b=a.dom();a.toggleClass("size-height",b.height>b.width),a.toggleClass("size-width",b.width>=b.height),this.fire("ready")}}}},properties:{src:{}},statics:{CSS:a.util.csssheet.create({".nx-centralized-image":{position:"relative",overflow:"hidden"},".nx-centralized-image > img":{position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",margin:"auto"},".nx-centralized-image > img.size-height":{width:"100%"},".nx-centralized-image > img.size-width":{height:"100%"}})}})}(nx),function(a){var b=(a.geometry.Matrix,a.util.cssstyle),c=a.define("nx.lib.component.SvgIcon",a.ui.Element,{view:{cssclass:"nx-comp svg-icon",content:{type:"nx.ui.tag.Image",attributes:{src:"{imgsrc}"}}},properties:{src:"",bgsrc:"",key:"",resize:null,fill:null,svg:{dependencies:"src",async:!0,value:function(a,b){this.release("svg"),b&&this.retain("svg",c.loadSvg(b,function(b){a.set(b)}))}},bgsvg:{dependencies:"bgsrc",async:!0,value:function(a,b){this.release("bgsvg"),b&&this.retain("bgsvg",c.loadSvg(b,function(b){a.set(b)}))}},imgsrc:{dependencies:"svg,bgsvg,key,resize,fill",value:function(d,e,f,g,h){if(!d)return"//:0";if(f){var i=d.querySelector("#"+f);if(!i)return"//:0";var j,k,l,m,n;return k=c.getSvgSize(d),e?(e=e.cloneNode(!0),g=c.getSvgSize(e)):(e=document.createElementNS("http://www.w3.org/2000/svg","svg"),g?(e.setAttribute("width",g.width+"px"),e.setAttribute("height",g.height+"px")):(e.setAttribute("width",k.width+"px"),e.setAttribute("height",k.height+"px"))),i=i.cloneNode(!0),i.removeAttribute("id"),c.cleanStyle(i),g&&g.width&&g.height&&(l=k.width,m=k.height,l&&m&&(scale=Math.min(g.width/l,g.height/m),n=Array([scale,0,0],[0,scale,0],[0,0,1]),j=document.createElementNS("http://www.w3.org/2000/svg","g"),j.appendChild(i),i=j,b.set(i,"transform",a.util.cssstyle.toCssTransformMatrix(n)))),b.set(i,"fill",h),e.appendChild(i),a.lib.svg.Svg.serialize(e)}return a.lib.svg.Svg.serialize(e||d)||"//:0"}}},statics:{cleanStyle:function(a){if(a instanceof Element){a.removeAttribute("class"),a.removeAttribute("style");var b,d=a.childNodes.length;for(b=0;d>b;b++)c.cleanStyle(a.childNodes[b])}},loadSvg:function(b,c){return a.util.ajax({url:b,success:function(a,b){if("string"==typeof b){var d=document.createElement("div");d.innerHTML=b,b=d.querySelector("svg")}else b.tagName&&"svg"===b.tagName.toLowerCase()||(b=b.querySelector("svg"));c(b)}})},getSvgSize:function(a){var b=a.getAttribute("width"),c=a.getAttribute("height"),d=a.getAttribute("viewBox");return b&&(b=1*b.replace(/[^-.0123456789]/g,"")),c&&(c=1*c.replace(/[^-.0123456789]/g,"")),d&&(d=d.split(" "),b=b||1*d[2]||0,c=b||1*d[3]||0),{width:b||0,height:c||0}},CSS:a.util.csssheet.create({".nx-comp.svg-icon":{position:"relative"},".nx-comp.svg-icon > img":{width:"100%",height:"100%",outline:"none",border:"0"},".nx-comp.svg-icon:after":{content:" ",position:"absolute",background:"transparent",left:"0",top:"0",width:"100%",height:"100%"}})}})}(nx),function(a,b){a.define("nx.topology.common.Util",{statics:{getIdFilter:function(b){return function(c){var d=a.path(c,"id"),e=b.get(d);return!e||e===c}},getTypeFilter:function(b){return function(c){return a.is(c,b)}},monitorOnCondition:function(a,b){return b.target&&b.property&&(b.monitorByTrue||b.monitorByFalse)?b.target.watch(b.property,function(c,d){var e=d?b.monitorByTrue:b.monitorByFalse;return e&&a.monitorContaining(e)}):void 0},getListSyncMonitor:function(a,b){return b!==!1?function(b){return a.push(b),function(){a.remove(b)}}:function(b){return a.remove(b),function(){a.push(b)}}},getIdMappingMonitor:function(a){return function(b){return a.set(b.id(),b),function(){a.remove(b.id())}}},getValuesByIds:function(a,b){var c,d,e,f=[],g=b?b.length:0;for(d=0;g>d;d++){if(e=b[d],c=a.get(e),!c)return null;f.push(c)}return f},createMapping:function(b,c){var d=c.sources,e=c.targets;d="string"==typeof d?d.split(","):d,e="string"==typeof e?e.split(","):e;return b.monitorContaining(function(b){var f=d.map(function(c){return a.path(b.originalData(),c.trim())});if(c.input){var g=c.input.apply(b,f);a.each(e,function(c,d){a.path(b,c.trim(),g[d])})}if(c.output)var h=a.Object.cascade(b,e,function(){f=c.output.apply(b,arguments),a.each(d,function(c,d){a.path(b.originalData(),c.trim(),f[d])})});return function(){h&&h.release()}})},buildDirectMappings:function(){var b=[],c=function(a){return[a]};return a.each(arguments,function(a){b.push({sources:a,targets:a,input:c,output:c})}),b},buildDirectMapping:function(){var a=function(a){return[a]};return{sources:arguments[0],targets:arguments[1],input:a,output:a}}}})}(nx,nx.global),function(a,b){a.define("nx.topology.common.FilterList",a.UniqueList,{methods:{match:function(a){var b=!0;return this.each(function(c){return"function"!=typeof c||c(a)?void 0:(b=!1,!1)}),b}}})}(nx,nx.global),function(a,b){a.define("nx.topology.common.FilterUniqueList",a.UniqueList,{properties:{filters:{set:function(){throw new Error("Unable to set filters of List")},watcher:function(a,b){this.release("syncFilters"),b&&this.retain("syncFilters",b.monitorContaining(function(a){if("function"==typeof a){var b,c=this._data,d=c.length;for(b=d-1;b>=0;b--)a(c[b])||this.removeAt(b)}},this))}}},methods:{init:function(b,c){this.inherited(b),this._filters=new a.topology.common.FilterList(a.is(c,"Array")||a.is(c,a.List)?c:c&&[c]),this.notify("filters")},_differ:function(a){var b=this.filters();if(!b)return this.inherited(a);for(c=0;c<a.length;c++){if("remove"!==a[c][0]){var c,d,e,f,g,h,i=this._data;if(1===a.length){switch(g=a[0],h=this._counting_map,g[0]){case"splice":for(e=g[3],f=i.slice(g[1],g[1]+g[2]),c=e.length-1;c>=0;c--)d=e[c],b.match(d)||(e===g[3]&&(e=e.slice(),a=[["splice",g[1],g[2],e]]),e.splice(c,1))}return a&&a.length?this.inherited(a):null}var j=this.inherited(a);for(c=i.length-1;c>0;c--)d=i[c],filter.match(d)||(i.splice(c,1),j.diffs===a&&(j.diffs=j.diffs.slice()),j.diffs.push(["splice",c,1,[]]),j.drops.push([d]),j.joins.push([]));return j}break}return this.inherited(a)}}})}(nx,nx.global),function(a,b){a.define("nx.topology.model.Entity",{properties:{originalData:null,id:null}})}(nx,nx.global),function(a,b){a.define("nx.topology.model.Vertex",a.topology.model.Entity,{properties:{edges:{value:function(){return new a.topology.common.FilterUniqueList}}}})}(nx,nx.global),function(a,b){a.define("nx.topology.model.Union",a.topology.model.Entity,{properties:{collapse:!1,vertexRoot:null,entities:{value:function(){return new a.topology.common.FilterUniqueList}},vertices:{value:function(){return new a.topology.common.FilterUniqueList}},entitiesVisible:{value:function(){return new a.topology.common.FilterUniqueList}},edges:{value:function(){return new a.topology.common.FilterUniqueList}}}})}(nx,nx.global),function(a,b){a.define("nx.topology.model.Edge",{properties:{originalData:null,id:null,source:null,target:null}})}(nx,nx.global),function(a,b){a.define("nx.topology.model.Connection",a.topology.model.Edge,{properties:{edges:{value:function(){return new a.topology.common.FilterUniqueList}}}})}(nx,nx.global),function(a,b){var c=a.path(b,"nx.topology.common.Util");a.define("nx.topology.model.Graph",{properties:{entitiesMap:{value:function(){return new a.Map}},vertices:{dependencies:"entitiesMap",value:function(b){if(b){var d=new a.topology.common.FilterUniqueList;return d.filters().push(c.getTypeFilter(a.topology.model.Vertex)),d.filters().push(c.getIdFilter(b)),d.monitorContaining(function(a){return b.set(a.id(),a),function(){b.remove(a.id())}}),d}}},edges:{dependencies:"entitiesMap, vertices",value:function(b,c){if(b&&c){var d=new a.topology.common.FilterUniqueList,b=this.entitiesMap();return c.monitorContaining(function(a){return function(){var b,c;for(b=d.length()-1;b>=0;b--)c=d.get(b),(c.source()===a||c.target()===a)&&d.splice(b,1)}}),d.filters().push(function(c){return c&&a.is(c,a.topology.model.Edge)&&c.target()&&c.source()?b.has(c.target().id())&&b.has(c.source().id()):!1}),d.monitorContaining(function(a){var c=b.get(a.source().id()),d=b.get(a.target().id());return c.edges().push(a),d.edges().push(a),function(){c.edges().remove(a),d.edges().remove(a)}}),d}}},edgeMap:{dependencies:"edges",value:function(b){var c=new a.Map;return b.monitorContaining(function(a){return c.set(a.id(),a),function(){c.remove(a.id())}}),c}},mappingVertices:{value:function(){var b=this,c=new a.topology.common.FilterUniqueList;return c.monitorContaining(function(a){var c=b.createVertexMapping(a);return function(){c.release()}}),c}},mappingEdges:{value:function(){var b=this,c=new a.topology.common.FilterUniqueList;return c.monitorContaining(function(a){var c=b.createEdgeMapping(a);return function(){c.release()}}),c}},statusListMap:{dependencies:"vertices, edges",value:function(b,c){return new a.Map({vertices:b,edges:c})}},statusDefinitionMap:{dependencies:"statusListMap",value:function(b){if(b){var c=new a.Map;return c.monitor(function(c,d){if(!d.relation)throw"No relation defined";var e,f=a.List.calculate(d.relation,b);return d.filter?(e=a.List.select(f,d.filter,d.condition),e.retain(f)):e=f,b.set(c,e),function(){e&&(b.remove(c),e.release(),e=null)}}),c}}}},methods:{init:function(b){if(this.inherited(),b){var c=a.path(b,"vertices"),d=a.path(b,"edges");a.each(c,function(a){this.vertices().push(this.createVertex(a))},this),a.each(d,function(a){this.edges().push(this.createEdge(a))},this)}},createVertex:function(b){var c=new a.topology.model.Vertex,d=a.path(b,"id");return d=null==d?a.uuid():d,c.id(d),c.originalData(b),c},createEdge:function(b){var c,d=a.path(b,"id")||a.uuid(),e=a.path(b,"source"),f=a.path(b,"target"),g=this.entitiesMap(),h=g.get(e),i=g.get(f);return h&&i?(c=new a.topology.model.Edge(b),c.id(d),c.originalData(b),c.source(h),c.target(i),c):null},createVertexMapping:function(a){return c.createMapping(this.vertices(),a)},createEdgeMapping:function(a){return c.createMapping(this.edges(),a)}}})}(nx,nx.global),function(a,b){var c=a.path(a.global,"nx.topology.common.Util"),d=a.define("nx.topology.model.CollapsibleGraph",a.topology.model.Graph,{properties:{entitiesParentMap:{value:function(){return new a.Map}},unions:{dependencies:"vertices, entitiesMap, entitiesParentMap, statusListMap",value:function(b,e,f,g){if(e&&f&&g){var h=new a.topology.common.FilterUniqueList;h.filters().push(c.getTypeFilter(a.topology.model.Union)),h.filters().push(c.getIdFilter(e)),h.filters().push(function(a){return a.entities().each(function(b){var c=f.get(b.id());if(c&&c!==a)throw new Error("Failed adding union "+a.id()+" which containing child "+b.id()+" belongs to some other union.")}),!0}),h.monitorContaining(c.getIdMappingMonitor(e)),h.monitorContaining(d.privates.unionLeafWatcher),h.monitorContaining(d.privates.unionEdgeWatcher),h.monitorContaining(d.privates.unionVisibleWatcher);var i=function(a){var b=f.get(a.id());b&&b.entities().remove(a)};return b.monitorContaining(function(a){return function(){i(a)}}),h.monitorContaining(function(a){var b=a.entities().monitorContaining(function(b){var c=f.get(b.id());return c&&c!==a&&c.entities().remove(b),f.set(b.id(),a),function(){f.remove(b.id())}});return function(){b.release(),i(a)}}),g.set("unions",h),h}}},entitiesTopLevel:{dependencies:"vertices, unions",value:function(b,d){if(b&&d){var e=new a.topology.common.FilterUniqueList;return b.monitorContaining(c.getListSyncMonitor(e)),d.monitorContaining(function(a){var b=a.entities().monitorContaining(c.getListSyncMonitor(e,!1));return e.push(a),function(){e.remove(a),b.release()}}),e}}},entitiesVisible:{dependencies:"entitiesMap, entitiesTopLevel",value:function(b,d){if(b&&d){var e=new a.topology.common.FilterUniqueList;return d.monitorContaining(function(d){var f;return e.push(d),a.is(d,a.topology.model.Union)&&(f=c.monitorOnCondition(d.entitiesVisible(),{target:d,property:"collapse",monitorByFalse:c.getListSyncMonitor(e),monitorByTrue:function(a){e.remove(a)}})),function(){f&&f.release(),b.get(d.id())||e.remove(d)}}),e}}},connections:{dependencies:"entitiesVisible",value:function(b){if(b){var c=new a.topology.common.FilterUniqueList,e=new a.topology.common.FilterUniqueList;b.monitorContaining(function(b){if(a.is(b,a.topology.model.Union)){var c=b.watch("collapse",function(a,c){e.toggle(b,c)});return function(){c.release()}}return e.push(b),function(){e.remove(b)}});var f={isContained:function(a,b){return a.entitiesVisible&&a.entitiesVisible().contains(b)},getRelated:function(a,b){var c;return e.each(function(d){if(d!==a&&d.edges().contains(b)){if(f.isContained(d,a)||f.isContained(a,d))return;return c=d,!1}}),c},map:{},cache:{},clear:function(a,b){var c,e;if(d.privates.compare(a,b)&&(c=b,b=a,a=c),e=f.map[a]){var g=e[b];if(g){var h=f.cache[a],i=f.cache[b];h.splice(h.indexOf(g),1),i.splice(i.indexOf(g),1)}delete e[b]}},set:function(a,b,c){var e,g;d.privates.compare(a,b)&&(e=b,b=a,a=e),g=f.map[a]=f.map[a]||{},g[b]=c;var h=f.cache;(h[a]=h[a]||[]).push(c),(h[b]=h[b]||[]).push(c)},get:function(a,b){var c,e;return d.privates.compare(a,b)&&(c=b,b=a,a=c),e=f.map[a],e&&e[b]}};return e.monitorContaining(function(b){var d=b.edges().monitorContaining(function(d){var e=f.getRelated(b,d);if(e){var g=b.id(),h=e.id(),i=f.get(g,h);return i||(i=new a.topology.model.Connection,i.source(b),i.target(e),f.set(g,h,i),c.push(i)),i.edges().push(d),function(){i.edges().remove(d),0===i.edges().length()&&(c.remove(i),f.clear(g,h))}}});return function(){var a,e,g=f.cache[b.id()];if(g)for(a=g.length-1;a>=0;a--)e=g[a],c.remove(e),f.clear(e.source().id(),e.target().id());d.release()}}),c}}},mappingUnions:{value:function(){var b=this,c=new a.topology.common.FilterUniqueList;return c.monitorContaining(function(a){var c=b.createUnionMapping(a);return function(){c.release()}}),c}}},methods:{init:function(b){this.inherited(b),this.statusListMap().set("unions",this.unions());var c,d,e,f=(a.path(b,"unions")||[]).slice();do for(d=f.length,c=f.length-1;c>=0;c--)(e=this.createUnion(f[c]))&&(this.unions().push(e),f.splice(c,1));while(f.length&&f.length!==d)},createUnion:function(b){var d,e,f,g,h,i=new a.topology.model.Union;return d=a.path(b,"id"),e=a.path(b,"root"),g=a.path(b,"entities")||[],f=this.entitiesMap().get(e),h=c.getValuesByIds(this.entitiesMap(),g),g.indexOf(d)>-1?null:h?(i.id(d),i.collapse(b.collapse),i.originalData(b),i.vertexRoot(f),i.entities().push.apply(i.entities(),h),i):null}},statics:{privates:{compare:function(a,b){return a>b},unionLeafWatcher:function(b){var d=b.vertices(),e=b.entities().monitorContaining(function(b){if(a.is(b,a.topology.model.Union)){var e=b.vertices().monitorContaining(c.getListSyncMonitor(d));return function(){e.release()}}return d.push(b),function(){d.remove(b)}});return function(){e.release()}},unionEdgeWatcher:function(a){var b=a.edges(),c=a.entities().monitorContaining(function(a){var c=a.edges().monitorContaining(function(a){return b.toggle(a),function(){b.toggle(a)}});return function(){c.release()}});return function(){c.release()}},unionVisibleWatcher:function(b){var d=b.entitiesVisible(),e=b.entities().monitorContaining(function(b){d.push(b);var e;return a.is(b,a.topology.model.Union)&&(e=c.monitorOnCondition(b.entities(),{target:b,property:"collapse",monitorByFalse:c.getListSyncMonitor(d),monitorByTrue:function(a){d.remove(a)}})),function(){e&&e.release(),d.remove(b)}});return function(){e.release()}},createUnionMapping:function(a){return c.createMapping(this.unions(),a)}}}})}(nx,nx.global),function(a,b){a.path(b,"nx.topology.common.Util"),a.define("nx.topology.model.TopologyModel",a.topology.model.CollapsibleGraph,{methods:{init:function(b){this.inherited(b.data),b&&b.mapping,b&&b.list&&a.each(b.list,function(a,b){this.statusDefinitionMap().set(b,a)},this)}}})}(nx,nx.global),function(a){var b=a.define("nx.topology.view.shape.DefaultNodeShape",a.lib.svg.shape.Node,{view:{cssstyle:{width:"{icon.width}",height:"{icon.height}"},content:[{type:"nx.lib.svg.shape.Text",content:"{icon.text.0}"},{type:"nx.lib.svg.shape.Text",content:"{icon.text.1}"}]},properties:{icon:{dependencies:"model.type",value:function(a){return b.ICONS[a]||b.ICONS.unknown}},topology:null,model:null},statics:{ICONS:{unknown:{width:32,height:32,text:["",""]},"switch":{width:32,height:32,text:["",""]},router:{width:32,height:32,text:["",""]},wlc:{width:32,height:32,text:["",""]},server:{width:32,height:32,text:["",""]},phone:{width:32,height:32,text:["",""]},nexus5000:{width:32,height:32,text:["",""]},ipphone:{width:32,height:32,text:["",""]},host:{width:32,height:32,text:["",""]},camera:{width:32,height:32,text:["",""]},accesspoint:{width:32,height:32,text:["",""]},groups:{width:32,height:32,text:["",""]},groupm:{width:32,height:32,text:["",""]},groupl:{width:32,height:32,text:["",""]},collapse:{width:16,height:16,text:["",""]},expand:{width:14,height:14,text:["",""]},cloud:{width:48,height:48,text:["",""]},unlinked:{width:32,height:32,text:["",""]},firewall:{width:32,height:32,text:["",""]},hostgroup:{width:32,height:32,text:["",""]},wirelesshost:{width:32,height:32,text:["",""]}}}})}(nx),function(a){a.define("nx.topology.view.Group",a.lib.svg.Node,{view:{cssclass:"group",content:a.binding("model.collapse",function(a){return a?"{content_collapsed}":"{content_expanded}"}),extend:{content_collapsed:{cssclass:"group-content-collapse",content:a.binding("topology.nodeShapeType",function(a){return{type:a,properties:{topology:"{topology}",model:"{model}"}}})},content_expanded:{cssclass:"group-content-expand",content:[a.binding("topology.groupShapeType",function(a){return{type:a,properties:{topology:"{topology}",model:"{model}"}}}),{repeat:a.binding("model.entities",function(b){return a.List.select(b,function(b){return a.is(b,a.topology.model.Union)})}),type:"nx.topology.view.Group",properties:{topology:"{scope.owner}",model:"{scope.model}"}},{repeat:a.binding("model.entities",function(b){return a.List.select(b,function(b){return!a.is(b,a.topology.model.Union)})}),type:"nx.topology.view.Node",properties:{topology:"{scope.owner}",model:"{scope.model}"}}]}}},properties:{topology:null,model:null}})}(nx),function(a){a.define("nx.topology.view.Node",a.lib.svg.Node,{view:{cssclass:"node",content:a.binding("topology.nodeShapeType",function(a){return{type:a,properties:{topology:"{topology}",model:"{model}"}}})},properties:{topology:null,model:null}})}(nx),function(a){a.define("nx.topology.view.Link",a.lib.svg.Node,{view:{cssclass:"link"}})}(nx),function(a){a.define("nx.topology.view.Topology",a.lib.svg.Svg,{view:{content:{name:"stage",attributes:{"class":"stage",style:{transform:a.binding("matrixInitial.matrix, matrix.matrix",function(b,c){return a.lib.svg.AbstractNode.cssTransformMatrix(b&&c&&a.geometry.Matrix.multiply(b,c))})}},content:[{repeat:a.binding("model.entitiesTopLevel",function(b){return a.List.select(b,function(b){return a.is(b,a.topology.model.Union)})}),type:"nx.topology.view.Group",properties:{topology:"{scope.owner}",model:"{scope.model}"}},{repeat:"model.connections",type:"nx.topology.view.Link",properties:{topology:"{scope.owner}",model:"{scope.model}"}},{repeat:a.binding("model.entitiesTopLevel",function(b){return a.List.select(b,function(b){return!a.is(b,a.topology.model.Union)})}),type:"nx.topology.view.Node",properties:{topology:"{scope.owner}",model:"{scope.model}"}}]}},properties:{model:null,matrixInitial:new a.geometry.Matrix,matrix:new a.geometry.Matrix,nodeShapeType:"nx.topology.view.shape.DefaultNodeShape",groupShapeType:"nx.topology.view.shape.DefaultGroupShape",linkShapeType:"nx.topology.view.shape.DefaultLinkShape"},methods:{init:function(b){this.inherited(),this.model(new a.topology.model.TopologyModel({data:b.data,mapping:b.mapping,lists:b.lists}))}}})}(nx);